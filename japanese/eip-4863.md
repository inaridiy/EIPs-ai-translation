---
original: a53ecf1c4acb065bf702241e9bc31b1649751e024338c9377963eb7e92fb5153
---

---
eip: 4863
title: ベーコンチェーンプッシュ引き出し
description: 新しい "プッシュスタイル" のトランザクションタイプを介して、ベーコンチェーンからEVMへのバリデーター引き出しをサポートする。
author: Alex Stokes (@ralexstokes), Danny Ryan (@djrtwo)
discussions-to: https://ethereum-magicians.org/t/eip-4863-beacon-chain-push-withdrawals/8465
status: 停滞
type: Standards Track
category: Core
created: 2022-02-28
---

## 概要

[EIP-2718 トランザクションタイプ](./eip-2718.md)を新しく導入し、ベーコンチェーンからEVMへの "プッシュ" 方式のバリデーター引き出しをサポートする。

ベーコンチェーンでの引き出し処理に関して、トランザクションが適切であることを確認するためのブロック検証を追加する。

## 動機

このEIPは、ベーコンチェーンで行われたバリデーター引き出しをEVMに反映させる方法を提供します。
このアーキテクチャは "プッシュ" ベースであり、"プル" ベースではありません。つまり、引き出しはベーコンチェーンからデキューされた時点で、即座に実行ブロックで処理される必要があります。

このアプローチは "プル" ベースの代替案 (例: [EIP-4788](./eip-4788.md) + ユーザー空間の引き出しコントラクト) よりも、コアプロトコルの観点から複雑ですが、重要な機能をプロトコル自体に密接に統合することができます。

## 仕様

| 定数                          | 値                                            | 単位
|---                            |---                                             |---
| `FORK_TIMESTAMP`              | 未定                                           |
| `WITHDRAWAL_TX_TYPE`          | `0x3`                                          | バイト

実行タイムスタンプ `FORK_TIMESTAMP` 以降、実行クライアントは以下の拡張をトランザクション処理とブロック検証に導入する必要があります:

### 新しいトランザクションタイプ

[EIP-2718](./eip-2718.md)に準拠した新しいトランザクションタイプを定義し、`TransactionType`を `WITHDRAWAL_TX_TYPE`とする。

`TransactionPayload`は、RLP-エンコードされたリスト `RLP([index, address, amount])` で、`index`は特定の引き出しを一意に識別する64ビットの値、`address`は実行レイヤーのアカウントを指し、`amount`はウェイ単位のイーサ値を表します。

これらの値はコンセンサスレイヤーから提供されます。

### ブロックの有効性

ブロックに `WITHDRAWAL_TX_TYPE` タイプのトランザクションが含まれる場合、それらはブロック内の他のすべてのトランザクションの後に来なければなりません。

実行クライアントがこの条件を満たさないブロックを受け取った場合、そのブロックを無効と見なす必要があります。

### トランザクション処理

`WITHDRAWAL_TX_TYPE` タイプのトランザクションを処理する際、実装では `WithdrawalTransaction` で指定された `address` の残高を `amount` のウェイ分増やす必要があります。

この残高の変更は無条件であり、失敗してはいけません。

このトランザクションタイプにはガスコストは関連付けられていません。

TODO: ログの追加?

## 根拠

### プッシュ vs プル アプローチ

このプッシュアプローチにより、バリデーターは通常のEVM処理で必要なガス代を支払う必要がなく、小さな補助金を得られます。

また、ベーコンチェーンの条件が満たされた際に自動的に行われるため、バリデーターにとってもユーザビリティが良くなります。

### なぜ新しいトランザクションタイプなのか?

このEIPでは、他の既存のEVMトランザクションタイプとは異なる特別な意味論を持つため、新しいトランザクションタイプを提案しています。

完全に新しいトランザクションタイプを設けることで、一般的なEVM実行とこの種の処理を分離し、引き出しのテストとセキュリティレビューを簡素化できます。

### なぜ新しいトランザクションタイプにガスコストがないのか?

実行レイヤーに到達できるこのトランザクションタイプの最大数は、コンセンサスレイヤーによって強制的に制限されており、その制限は小さく保たれているため、実行レイヤーの運用コストは全体的なブロック実行の文脈では無視できるレベルです。

### なぜ残高の更新のみなのか? 一般的なEVM実行はないのか?

より一般的な処理を行うと、失敗のリスクが高まり、ベーコンチェーンの会計処理が複雑になります。

このEIPは、ほとんどの利点を最小限のコスト (複雑性) で提供する引き出しのルートを提案しています。

### なぜ新しいブロック検証が必要なのか?

ベーコンチェーンは、自身の内部スケジューリングロジックに基づいて、特定の実行ブロック内の引き出しトランザクションが期待されるものであることを効率的に検証できる必要があります。

ブロック内のすべての引き出しトランザクションを最後に配置することを要求することで、チェックアルゴリズムは既知の小さな数までの単純な線形走査になります。

このような単純な順序付けスキームを持つことで、引き出しの処理に関するクライアントの最適化が容易になります。一方、引き出しトランザクションをブロック内で自由に配置できる場合、最適化が困難になります。

## 下位互換性

問題はありません。

## セキュリティ上の考慮事項

引き出しトランザクションのコンセンサスレイヤーによる検証は、適切な量のETHがEVMに引き出されるようにするために非常に重要です。
このコンセンサスレイヤーから実行レイヤーへのETH転送は、EVMでは現在の類似例がなく、非常に高いセキュリティレビューが必要です。

## 著作権

著作権およびそれに関連する権利は [CC0](../LICENSE.md) で放棄されています。