---
original: d8146d92455fcf3b911d910439318bf9cd6c5299fb7285d2c68b2bfcfc943639
---

---
eip: 7577
title: EIPのバージョニングスキーム
description: EIPの仕様セクションに加えられた変更に基づいて、EIPのバージョニングスキームを使用する。
author: danceratopz (@danceratopz), Ahmad Bitar (@smartprogrammer93)
discussions-to: https://ethereum-magicians.org/t/add-eip-versioning-scheme-for-eips/17295
status: Draft
type: Meta
created: 2023-12-13
---

## 概要

このEIPは、[Standards Track](./eip-1.md#eip-types) EIPのバージョニングスキームを導入します。ステータスが「Draft」から「Review」に変更された後、[Semantic Versioning 2.0.0](../assets/eip-7577/semver.md)に基づいてEIPの仕様セクションに加えられた変更に応じて適用されます。

## 動機

EIPの仕様は、より多くの人々がレビューするにつれて、一般的に変更が増えていきます。これは、クライアントチームがその仕様の実装を開始し、コミュニティがプロトコルの残りの部分との相互作用をより良く理解するにつれて起こります。これらの変更を追跡するのは難しい場合があります。特に、EVMリファレンステストがクライアントチームやEIPの作者によって一般的に維持されておらず(そして一般的に公開されていない)ため、リファレンステストのリリースが最新のEIP仕様やクライアントによって現在実装されている仕様をテストするのに十分であるかどうかを確認するのは難しい場合があります。

このEIPは、セマンティックバージョニングスキームとCHANGELOGセクションの追加を提案することで、コミュニティ内のコミュニケーションをより明確にし、変更の範囲を一目で把握できるようにします。さらに、クライアントの実装とテストツールチェーンは、EIPの変更を照会し、EIPの現在の仕様とクライアントおよびテストの実装との間の非互換性を自動的にフラグ付けできるようになります。

## 仕様

この文書の中の「MUST」、「MUST NOT」、「REQUIRED」、「SHALL」、「SHALL NOT」、「SHOULD」、「SHOULD NOT」、「RECOMMENDED」、「NOT RECOMMENDED」、「MAY」、「OPTIONAL」というキーワードは、RFC 2119およびRFC 8174に記載されているように解釈されるものとします。

EIPが「Draft」ステータスから移行した後、以下に概説するEIPバージョニングスキームを使用しなければなりません(MUST)。「Draft」ステータスの間は、仕様が積極的に実装されている場合、このバージョニングスキームを使用してもよい(MAY)。複数のチームが仕様を実装している場合は、EIPのステータスを「Review」に変更することをお勧めします(RECOMMENDED)。

EIPバージョニングスキームは、[Semantic Versioning 2.0.0](../assets/eip-7577/semver.md)に基づいて、`MAJOR.MINOR.PATCH`のセマンティックバージョニングスキームを適用しなければなりません(MUST):

1. `MAJOR`: 実装の変更とリファレンステストの変更を必要とする仕様の破壊的な変更。
2. `MINOR`: 追加の実装と、リファレンステストに追加のテストカバレッジを必要とする仕様の追加。
3. `PATCH`: 仕様の変更なしに、EIPの修飾や書き換えを行う変更。

EIPがDraftステータスから移行していない間、バージョン番号は初期的に`MAJOR`バージョンを`0`に設定しなければなりません(MUST)。

ethereum/EIPsへのプルリクエスト(PR)を通じてEIPに変更が加えられるたびに、変更内容を説明するCHANGELOGセクションの新しいエントリを追加しなければなりません(MUST)。このCHANGELOGエントリには以下を含める必要があります:

1. 上記のセマンティックバージョニングスキームに従った新しいバージョン番号。
2. 変更が導入された日付。
3. 変更を実装するethereum/EIPsのPR番号。
4. EIPの仕様に加えられた各変更について、変更の簡単な説明を含む行。

さらに、新しいバージョンをEIPのMarkdownファイルのメタデータヘッダーに追加する(新しい "version" フィールドに)必要があります。これにより、簡単に解析できるようになります。

ethereum/EIPsリポジトリにツールを追加して、EIPの作者がバージョニングスキームを適用するのを支援する必要があります。このツールは以下を自動的に行うべきです:

1. EIPのMarkdownファイルのメタデータヘッダーでEIPバージョンを更新する。EIPのステータスが「Draft」から「Review」に変更された場合、バージョンを`1.0.0`に更新する必要があります。
2. PRのタイトルに基づいて、新しいCHANGELOGエントリを追加する。

これらの変更を行えるようにするために、EIPの作者はPRのブランチにプッシュされたコミットメッセージの1つで変更の範囲を示す必要があります(MUST)。範囲は、コミットメッセージの先頭に「(`[Mm]ajor:`」、「`[Mm]inor:`」、または「`[Pp]atch`」)を付けることで示します。複数のコミットメッセージに範囲が含まれている場合は、最も深刻な範囲の変更が適用されます。コミットメッセージのいずれにも範囲が検出されない場合、そのようなコミットメッセージがプッシュされるまでPRのマージがブロックされます。

## 根拠

EIPのメタデータヘッダーでバージョンを利用可能にすることで、ツールによるプログラム的なバージョン番号の解析が可能になります。現在、Ethereum実行クライアントのコンセンサステストを含む execution-spec-tests リポジトリでは、EIPバージョンチェッカーを初歩的に実装しています。EIPの仕様テストは、テストの実装の基となったEIPのMarkdownファイルのダイジェストSHAを宣言する必要があります。現在のダイジェストSHAの値は、Github APIを介して照会され、変更が発生していないことを確認します。これにより、テストの実装者にEIPが変更されたことを警告することができますが、その使用範囲は限定的です。

このEIPで定義されているより豊かなバージョニングスキームは、テストツールチェーンに多くの価値をもたらすことができます。クライアントチームは、現在実装しているEIPバージョンを報告するインターフェイスを提供できます。リファレンステストは、生成されたテストのメタデータでテストが実装しているバージョンを指定できます。これにより、テストランナーは、`MAJOR`または`MINOR`バージョンが一致しない場合、テストをxfail(期待どおりに失敗する)としてマークし、警告を発行できます。さらに、クライアントの実装に対して適切なバージョンのリファレンステストを自動的に選択することも可能です。ただし、Ethereumの開発のペースを考えると、複数のバージョンのテストを維持し、追跡するのは実用的ではない可能性があります。

### ケーススタディ

このセクションでは、執筆時点で活発に開発されていた既存のEIPを例として、バージョニングスキームの適用方法を探ります。

[EIP-4788](./eip-4788.md)の履歴には、その仕様への多くの変更が含まれています。EIP-4788は2023-11-28にステータス「Review」に更新されました。ただし、このケーススタディでは、EIPが2023-04-11にステータス「Review」に移行し、クライアントチームの実装の開始に伴い、バージョン1.0.0に更新されたと仮定します。

#### 変更履歴

- 9.0.1 - 2023-09-26: 新しいリングバッファサイズのための理由付けを更新, #7786.
- 9.0.0 - 2023-09-26: 監査後の微調整, #7672.
  - タイムスタンプが0以外であることを確認.
  - `HISTORY_BUFFER_LENGTH`を素数(8191)にする.
  - コールデータを1回読み込む.
  - `BEACON_ROOTS_ADDRESS`を更新.
- 8.0.1 - 2023-08-28: 4788のクリーンアップ, #7532.
- 8.0.0 - 2023-08-24: v2の初期実装, #7456.
  - タイムスタンプ入力が正確に32バイトであることを要求.
  - 保存されたタイムスタンプ値と一致しない場合、リバートする(ゼロ埋めされた単語を返すのではなく).
  - プリコンパイルの概念を削除し、提供されたバイトコードを持つ通常のスマートコントラクトを使用.
- 7.0.3 - 2023-08-01: ジェネシスブロックに既存のビーコンブロックルートがない場合について言及, #7445.
- 7.0.2 - 2023-07-07: ヘッダースキーマを明示的に指定, #7297.
- 7.0.1 - 2023-07-07: タイポを修正, #7293.
- 7.0.0 - 2023-07-05: プリコンパイルストレージを制限, #7178.
- 6.0.1 - 2023-06-13: ヘッダーと有効性のセクションを明確化, #7179.
- 6.0.0 - 2023-06-12: プリコンパイルアドレスを更新, #7173.
- 5.0.0 - 2023-05-31: ルートでビーコンルートをキー付け, #7107.
- 4.0.0 - 2023-05-24: オペコードよりもステートフルなプリコンパイルを好む, #7065.
- 3.0.0 - 2023-05-17: タイムスタンプ変換を避けるためにCLから現在のスロットを送信, #7037.
- 2.0.1 - 2023-05-15: タイポを修正, #7005.
- 2.0.0 - 2023-05-03: 衝突を避けるためにオペコードを更新, #6980.
- 1.0.1 - 2023-04-13: 軽微な修正, #6870.
- 1.0.0 - 2023-04-11: ブロックルートを使用; ステータスを「Draft」に更新, #6859.
  - クライアントの実装(NethermindEth/nethermind#5476)に伴い、ステータスを「Draft」に更新.
  - ステートルートではなくブロックルートを使用.
  - ルートはスロットでキー付けされて保存される.
  - ステートでリングバッファを使用.
  - 追加のヘッダースペースを消費するのではなく、ヘッダータイムスタンプを使ってスロット番号を導出.
- 0.2.1 - 2023-02-04: ステータスを「Stagnant」に更新, #6432.
- 0.2.0 - 2022-06-29: 「ビーコンブロックルート」を「ビーコンステートルート」に改名, #5090.
- 0.1.1 - 2022-05-06: 同梱のLICENSEファイルの使用を強制, #5055.
- 0.1.0 - 2022-02-17: EIP-4788: EVMでのビーコンステートルートの追加, #4788.

## 下位互換性

このEIPの導入前のEIPのバージョンに対して、遡ってCHANGELOGやバージョンを追加する必要はありません。EIPの仕様セクションに次の変更が加えられる際に、CHANGELOGセクションとセマンティックバージョニングスキームに従った新しいバージョン番号を導入する必要があります。

## セキュリティ上の考慮事項

なし。

## 著作権

著作権およびそれに関連する権利は[CC0](../LICENSE.md)により放棄されています。