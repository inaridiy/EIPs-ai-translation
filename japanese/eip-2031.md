---
original: 2023f0ee600e9e1a4f4a453f3201e69d0ecb87980013362ec4cc1a6032f73921
---

---
eip: 2031
title: State Rent B - ネットトランザクションカウンター
author: Alexey Akhunov (@AlexeyAkhunov)
discussions-to: https://ethereum-magicians.org/t/eip-2031-net-transaction-counter-change-b-from-state-rent-v3-proposal/3283
status: 停滞
type: Standards Track
category: Core
created: 2019-05-15
requires: 2029
---

## 簡単な要約
Ethereumは、その状態の中でトランザクションの数を追跡し始めます(現時点では、この変更が導入された後のトランザクション数のみ、そのため *Net* トランザクションカウントと呼ばれます)。
これは、*State counter contract*と呼ばれる特別なコントラクトの格納スロットをインクリメントすることで行われます([EIP-2029](./eip-2029.md))。

## 概要
これは State Rent ロードマップの一部です。この特定の変更により、Ethereumのトランザクションはすべて、*State counter contract*の特別な格納スロットのトランザクションカウンターをインクリメントします。このカウンターは、新しく作成された非コントラクトアカウントのnonce(ワンタイムパスワード)を設定するために使用されます。このnonce設定方法により、退出されて後に Ether を送信することで復活したアカウントに対するリプレイ保護が確保されます。

## 動機
Ethereumには現在、トランザクション数を追跡する特別な場所がありません。

## 仕様
state counter contractの0番目の位置(つまり、状態のストレージスロット0に存在し、32バイトのゼロを引数として呼び出すことで読み取れる)に新しいフィールド `txCount` が追加されます。これには、その時点までに処理されたトランザクションの総数が含まれます。
ブロックBの後、または state counter contract のデプロイ後(どちらか先に起こったほう)、各トランザクション後に `txCount` フィールドがインクリメントされます。`txCount` の更新とは、state counter contract のストレージ位置0の更新を意味します。これらの変更は決して元に戻されることはありません。

## 根拠
退出されて後に Ether を送信することで復活したアカウントに対するリプレイ保護のために、2つの主要な代替案が提案されました:
1. 時間的なリプレイ保護。新しいアカウント(および復活したもの)のnonceはまだゼロですが、新しい `valid-until` フィールドが導入され、このフィールドに指定された時間以降の取引は無効になります。ただし、アカウントnonceはリプレイ保護だけでなく、デプロイされたコントラクトのアドレスを計算するためにも使用されるため(`CREATE2`で作成されたものを除く)、望ましくない副作用があります。
2. 新しいアカウント(および復活したもの)のnonceを、現在のブロック番号に依存するものに設定すること。このアプローチでは、新しいnonceが既存のnonceと衝突しないように、ブロック内の最大トランザクション数という任意のパラメーターを考案する必要があります。これは主に、ブロック内のトランザクション数が大幅に多くなる可能性のあるプライベートネットワークの問題です。

## 下位互換性
この変更は下位互換性がなく、ハードフォークによってアクティブ化される必要があります。

## テストケース
テストケースは、参照実装から生成されます。

## 実装
仕様を洗練および明確化するためのプルーフオブコンセプト実装が行われます。

## 著作権
[CC0](../LICENSE.md)によって著作権およびそれに関連する権利が放棄されています。