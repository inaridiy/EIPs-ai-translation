---
original: d5ec04c6cbe4441e3c2770789fa7ee6484d3014e4b2e7cc3d0471d90dca864eb
---

---
eip: 7623
title: コールデータコストの増加
description: コールデータコストの増加により、最大ブロックサイズを減少させる
author: Toni Wahrstätter (@nerolation), Vitalik Buterin (@vbuterin)
discussions-to: https://ethereum-magicians.org/t/eip-7623-increase-calldata-cost/18647
status: Review
type: Standards Track
category: Core
created: 2024-02-13
---



## 概要

現在のコールデータ価格設定では、最大2.8MBのブロックサイズが可能ですが、平均ブロックサイズは125KBと小さくなっています。
このEIPでは、Ethereumのコールデータコストを調整し、データ可用性(DA)に主に使用されるトランザクションの最大ブロックサイズと分散を減らすことを提案しています。
これは、主にEthereumでデータ可用性に使用されるトランザクションのコールデータコストを引き上げることで実現されます。


## 動機

ブロックガスリミットは[EIP-1559](./eip-1559.md)以降増加していませんが、ロールアップがEthereumにデータを投稿する件数の増加により、平均ブロックサイズは継続的に増加しています。さらに、[EIP-2028](./eip-2028)以降、コールデータコストは調整されていません。
[EIP-4844](./eip-4844.md)では、データ可用性(DA)の優先手段としてblob(ブロブ)が導入されます。
この移行に伴い、特に平均ブロックサイズと最大ブロックサイズの非効率性を軽減するためにコールデータ価格の再評価が必要です。
このプロポーザルでは、主にEthereumでデータ可用性に使用されるトランザクションのコールデータに依存する最低コストを導入することで、最大ブロックサイズを削減し、より多くのblobを追加する余地を作ることを目的としています。


## 仕様

| パラメータ | 値 |
| - | - |
| `STANDARD_TOKEN_COST`    |  `4` |
| `TOTAL_COST_FLOOR_PER_TOKEN`    |  `10` |


`tokens_in_calldata = zero_bytes_in_calldata + nonzero_bytes_in_calldata * 4`と定義します。

`isContractCreation`はコントラクト作成イベントを示すブール値とします。

通常のトランザクションのガス消費量計算式は`nonzero_bytes_in_calldata * 16 + zero_bytes_in_calldata * 4`と表されますが、これは以下と等価です:

```python
tx.gasused = (
    21000 \ 
        + isContractCreation * (32000 + InitCodeWordGas * words(calldata)) \
        + STANDARD_TOKEN_COST * tokens_in_calldata \
        + evm_gas_used
)
```

トランザクションのガス消費量計算式は以下のように変更されます:

```python
tx.gasUsed = {
    21000 \ 
    + 
    max (
        STANDARD_TOKEN_COST * tokens_in_calldata \
           + evm_gas_used \
           + isContractCreation * (32000 + InitCodeWordGas * words(calldata)),
        TOTAL_COST_FLOOR_PER_TOKEN * tokens_in_calldata
    )
}
```

実装にあたっては、実行後の無効化を避けるため、`TOTAL_COST_FLOOR_PER_TOKEN`を事前に差し引く必要があります。

## 根拠

現在の最大ブロックサイズは約1.79MB(`30_000_000/16`)です。ゼロバイトのみで構成されたブロックは最大7.5MBまで作成できますが、現在はp2pレイヤーでsnappyコンプレッションが標準となっているため、そのようなゼロバイト主体のブロックは実際には1.79MB未満になります。[EIP-4844](./eip-4844.md)の実装により、これは約2.54MBまで増加しました。さらに、[EIP-2028](./eip-2028)以降、コールデータバイトのコストは調整されていません。

このプロポーザルでは、EVMオペレーションに費やされるガスの一定しきい値を超えないトランザクションのコールデータコストを10/40ガスに引き上げることを提案しています。この変更により、純粋なデータトランザクションの数と大きさを制限することで、最大ブロックサイズを大幅に減少させることができます。具体的には、データ可用性(DA)トランザクションのコールデータバイトコストを4/16ガスから10/40ガスに調整することで、ほとんどのユーザーに影響を与えずに、最大ブロックサイズを約0.72MBまで引き下げることを目指しています。


この縮小により、ブロックガスリミットの増加やblobの数の増加が可能になりますが、同時にネットワークのセキュリティと効率性も確保されます。
重要なのは、ETH/トークン/NFTの送信、DeFi、ソーシャルメディア、restaking、ブリッジングなど、Ethereumをデータ可用性(DA)にほとんど使用しないユーザーには影響がないことです。
EVMコンピュテーションに大きく関与するトランザクションのコールデータコストは4/16ガスのままで、これらのトランザクションには変更がありません。


## 下位互換性

これは下位互換性のないガス再価格付けであり、予定されたネットワークアップグレードが必要です。

ユーザーは変更なしに引き続き操作できます。

## セキュリティ上の考慮事項

最大ブロックサイズが縮小されるため、セキュリティ上の懸念は指摘されていません。

## 著作権

著作権およびそれに関連する権利は[CC0](../LICENSE.md)で放棄されています。