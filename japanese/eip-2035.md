---
original: cee4f33de60545c24fecddd92f0a53401b59faaa39144805f8f5d41c2faf56a3
---

---
eip: 2035
title: ステートレスクライアント - SLOAD およびSSTOREのガス代を増額してブロックプルーフの費用を支払う
author: Alexey Akhunov (@AlexeyAkhunov)
discussions-to: https://ethereum-magicians.org/t/eip-2035-stateless-clients-repricing-sload-and-sstore-to-pay-for-block-proofs/3284
status: 停滞
type: Standards Track
category: Core
created: 2019-05-16
---

## 簡単な要約
EVM命令`SLOAD`および`SSTORE`のガス代が増額されます。これは、ブロックヘッダーおよびブロック本体とともにブロックプルーフを伝播するために必要な帯域幅の増加に対応するためです。詳細は[こちら](https://medium.com/@akhounov/data-from-the-ethereum-stateless-prototype-8c69479c8abc)をご覧ください。

## 概要
これは「State Rent」ロードマップの一部です。この変更により、ブロックプルーフの導入に備えてEthereumが準備されます(現時点の理解では、ハードフォークなしでブロックプルーフを導入できます)。ブロックプルーフの導入により、Ethereumノードはブロックの状態にアクセスせずにトランザクションを処理できるようになります。実行に必要な情報(および有効性の証明)はすべてブロックプルーフに含まれています。ほとんどのEthereumノードでは、ブロック処理が高速化され、メモリフットプリントが小さくなります。ただし、マイニングノードの場合、ブロックプルーフの構築と送信にはより多くの作業が必要になります。そのため、追加の手数料(マイナーに支払われる)が導入されます。最初のフェーズでは、コントラクトストレージのみがブロックプルーフの対象となります。つまり、Ethereumノードはアカウントの状態にアクセスする必要がありますが、ブロックプルーフにより、トランザクションの実行にコントラクトストレージへのアクセスが不要になります。したがって、影響を受けるのは`SSTORE`および`SLOAD`命令のみです。

## 動機
`SLOAD`命令のガス代が、ブロック処理に追加される実行遅延に対して過小評価されているという[実証分析](https://github.com/holiman/vmstats/blob/master/README.md)があります。その理由は、データベースアクセスの遅延によるものと考えられています。同じ分析では、`SSTORE`は考慮されていません。これは、ブロックの最後まで`SSTORE`の影響をデータベースアクセスに遅延させることができ(多くの実装で行われている)、その影響が小さいためです。ステートレスクライアントのアプローチでは、データベースアクセスがほとんど不要になるため、この遅延はほとんど問題になりません。その代わりに、帯域幅の消費が増加します。未公開の実証分析によると、キャッシュされていない`SSTORE`または`SLOAD`は、ブロックプルーフに最大1 kBを追加すると推定されています。現在のデータ送信コスト(1バイトあたり68ガス)を考えると、両方の操作のガス代を69kガス増加させる必要があります。ただし、[EIP-2028](./eip-2028.md)の提案を考慮すると、増加幅をさらに小さくできる可能性があります。

## 仕様
現時点では正式ではありませんが、さらなる調査とプロトタイピングを経て正式化されます。`SLOAD`および`SSTORE`操作のガス代は、アクセスされたストレージスロット(`SLOAD`で読み取られ、`SSTORE`で書き込まれたもの)が、同一トランザクション内で以前にアクセスされていない場合、`X`ガス増加します。

*Gross contract size accounting*の実装後に可能となる将来のバリアントとして、コントラクトストレージのサイズに応じて増加幅を変化させる方法が検討されています。つまり、小さなコントラクトの`SLOAD`および`SSTORE`は、より安価になります。

## 根拠
[EIP-1884](./eip-1884.md)は、実行の遅延を理由として`SLOAD`のガス代を引き上げようとしています。このEIPでは、`SLOAD`のガス代をさらに大幅に引き上げる可能性があるため、部分的に(EIP-1884が提案する他の引き上げも含めて)EIP-1884に取って代わります。

[EIP-2028](./eip-2028.md)は、データ送信のガス代を決定するためのモデルについて説明しています。ステートレスクライアントの体制では、`SSTORE`および`SLOAD`操作によってより多くのデータが送信される(プルーフの検証計算も増加する)ため、関連しています。

別の設計案としては、コントラクトストレージのサイズに比例したレントがありますが、これは深刻な嫌がらせの脆弱性の問題を引き起こすため、現時点では解決策がありません。しかし、このアプローチはエコシステムレベルでは非常に高価になる可能性があります。

## 下位互換性
この変更は下位互換性がなく、ハードフォークによってアクティブ化する必要があります。
既存のコントラクトにも悪影響を及ぼす可能性があります。このEIPと[EIP-2026](./eip-2026.md)(アカウントのレント前払い)の後は、ガスリミットを引き上げることが推奨されると予想されます。これにより、EIPの悪影響を幾分緩和できるかもしれません。最も問題となるのは、`SLOAD`および`SSTORE`のガス代を前提としてガス計算を内部で行っているコントラクトです。その他のコントラクトでは、ストレージへのアクセスコストが上昇し、そのようなアクセスに依存するdAppsが成り立たなくなる可能性があります。これは、コントラクトストレージサイズに比例したレントによる悪影響をより小さくするための trade-off です。ただし、影響を受ける可能性のあるコントラクトをより詳細に分析するためには、さらなる調査が必要です。

## テストケース
テストケースは、参照実装から生成されます。

## 実装
仕様を洗練・明確化するための実証実験が行われます。

## 著作権
著作権およびその関連権利は[CC0](../LICENSE.md)で放棄されています。