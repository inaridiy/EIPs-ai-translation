---
original: 28527dbb665e9897e98103fa9275e46a4c7632297a6c01f01d612a0ae833d30b
---

---
eip: 4938
title: "eth/67 - GetNodeDataの削除"
description: "ワイヤープロトコルからGetNodeDataとNodeDataメッセージを削除する"
author: Marius van der Wijden (@MariusVanDerWijden), Felix Lange <fjl@ethereum.org>, Gary Rong <garyrong@ethereum.org>
discussions-to: https://ethereum-magicians.org/t/eip-4938-removal-of-getnodedata/8893
status: Final
type: Standards Track
category: Networking
created: 2022-03-23
requires: 2464, 2481
---

## 概要

[Ethereum Wire Protocol](https://github.com/ethereum/devp2p/blob/40ab248bf7e017e83cc9812a4e048446709623e8/caps/eth.md)は、クライアント間でデータを交換するためのリクエストとレスポンスメッセージを定義しています。`GetNodeData`リクエストは、ハッシュによってステートトライからトライノードやコントラクトコードのセットを取得します。`GetNodeData`と`NodeData`メッセージをワイヤープロトコルから削除することを提案します。

## 動機

`GetNodeData`と`NodeData`は、ステートを実行せずにイーサリアムステートをダウンロードする「高速同期」と呼ばれる同期モードを可能にするために、プロトコルバージョン`eth/63`で導入されました。同期アルゴリズムは、ステートトライノードとコントラクトコードをそのハッシュによって要求することで動作します。

`GetNodeData`リクエストに応答するには、クライアントがハッシュからトライノードへのマッピングを保存する必要があります。このようなマッピングをデータベースに保存する必要がないことが、このリクエストタイプを削除する主な動機です。

現時点では、一部のクライアント実装では状態を互換性のある方法で保存していないため、`GetNodeData`リクエストに応答できません。Ethereum Wire Protocolは、クライアントの機能を正確に反映する必要があり、一部のクライアントでは実装できないメッセージを含むべきではありません。

## 仕様

`eth`プロトコルから以下のメッセージタイプを削除します:

* `GetNodeData (0x0d)`
   * **(eth/66)**: `[request_id: P, [hash_0: B_32, hash_1: B_32, ...]]`
* `NodeData (0x0e)`
   * **(eth/66)**: `[request_id: P, [value_0: B, value_1: B, ...]]`

## 根拠

`GetNodeData`の代替手段は[snap protocol](https://github.com/ethereum/devp2p/blob/40ab248bf7e017e83cc9812a4e048446709623e8/caps/snap.md)にあります。具体的には、クライアントは[GetByteCodes](https://github.com/ethereum/devp2p/blob/40ab248bf7e017e83cc9812a4e048446709623e8/caps/snap.md#getbytecodes-0x04)と[GetTrieNodes](https://github.com/ethereum/devp2p/blob/40ab248bf7e017e83cc9812a4e048446709623e8/caps/snap.md#gettrienodes-0x06)メッセージを使用して、`GetNodeData`の代替手段を使用できます。snapプロトコルを使用して「高速同期」アルゴリズムを実装することができますが、「snap同期」に使用することをお勧めします。

## 下位互換性

このEIPは`eth`プロトコルを変更し、新しいバージョン`eth/67`のリリースが必要です。ワイヤープロトコルの複数のバージョンをサポートすることは可能です。新しいバージョンをロールアウトしても、古いクライアントは直ちに破壊されることはありません。プロトコルバージョン`eth/66`を継続して使用できます。

このEIPはEVMのコンセンサスルールを変更せず、ハードフォークを必要としません。

## セキュリティ上の考慮事項

なし

## 著作権

[CC0](../LICENSE.md)によりすべての著作権およびそれに関連する権利が放棄されています。