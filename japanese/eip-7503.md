---
original: a45a12397036034e19674f672276e595f8b04edc5c49a5fa0af612e7e6ee57b1
---

---
eip: 7503
title: ゼロ知識ワームホール
description: イーサリアムのネイティブプライバシーソリューションとして、秘密裏に焼却されたイーサーの鋳造を可能にする
author: Keyvan Kambakhsh (@keyvank), Hamid Bateni (@irnb), Amir Kahoori <a.kahoorizadeh@gmail.com>, Nobitex Labs <labs@nobitex.ir>
discussions-to: https://ethereum-magicians.org/t/eip-7503-zero-knowledge-wormholes-private-proof-of-burn-ppob/15456
status: 停滞
type: Standards Track
category: Core
created: 2023-08-14
---

## 概要

プライバシーソリューションとZKPの応用について研究する中で、人々がデジタル資産(例えば ETH)を使用不可能なアドレスに送信することで焼却し、その後ZKプルーフを構築して、アカウントに存在する使用不可能なトークンの量を明らかにせずに表示する手法を発見しました。

このEIPは、人々が故意に焼却したイーサーを再鋳造できるように、イーサリアムにミンティング機能を追加することを提案しています。提案のプライバシーソリューションは、送信者がプライバシープロトコルに参加したことを証明する方法がないため、送信者に強力な「否認可能性」を提供します。これにより、デフォルトで発信トランザクションのない全てのイーサリアムアカウントが匿名プールに含まれるようになります。

## 仕様

楕円曲線ベースのデジタル署名では、通常、秘密のスカラー値 $s$ から公開鍵が計算されます(ジェネレーターポイントにスカラーを乗算して: $s \times G$)。イーサリアムのEOAアドレスは、公開鍵のkeccakハッシュです。

また、スマートコントラクトのパラメータのkeccakハッシュがアドレスと等しい場合、そのアドレスの資金はスマートコントラクトによって使用可能になる可能性があります。

したがって、イーサリアムアドレス $A$ は以下の場合にのみ使用可能です:

 1. 秘密鍵 $s$ が存在し、$A = keccak(s \times G)$ である。
 2. パラメータ $c_{params}$ を持つスマートコントラクト $c$ が存在し、$A = keccak(c_{params})$ である。

ハッシュ関数の前像耐性により、ランダムな値 $r$ に対して $keccak(x)=r$ となる $x$ を見つけることはできません。したがって、ランダムなイーサリアムアドレス $r$ に送信された資金は使用不可能ですが、$r$ が本当にランダムであり $s \times G$ の計算結果ではないことをどのように確認できるでしょうか?

ハッシュ関数は優れたランダム性の源です。アドレスが秘密の前置詞 $s$ のハッシュ値と等しい場合、$keccak(x)=h(s)$ となる $x$ を多項式時間アルゴリズムで見つけるのは不可能なため、そのアドレスは使用不可能であると結論付けることができます。これは、2つのハッシュ関数 $h_1$ と $h_2$ が異なる場合にのみ成り立ち、$h_1(x_1)=h_2(x_2)$ となる $x_1$ と $x_2$ を見つけるのが不可能であると仮定しています。

ゼロ知識証明の助けを借りて、$s$ の値を隠すことができます。 $s$ が存在し、アドレスが $h(s)$ であることを証明するだけで十分です。さらに進んで、状態ルートに存在し、使用不可能な一定量のETHを保有するイーサリアムアカウントの存在を証明することができます。

このことをイーサリアムブロックチェーンに明らかにし、二重鋳造を防ぐためのヌリファイアー(例えば $h(s | 123)$)を提供することで、人々が秘密裏に焼却したトークンを完全に新しいアドレスに移行できる新しい***ミンティング***機能をイーサリアムに追加することができます。ターゲットアドレスも焼却アドレスにすることで、再鋳造された資金を匿名プールに維持することができます。

## 根拠

TornadoCashのようなクリプトマネーミキサーは、イーサリアムのトランザクションを効果的に難読化できますが、政府がそれらの使用を禁止するのは簡単です。ミキサーコントラクトとやり取りした送信者や受信者は、マークされる可能性があります。しかし、このEIPは、スマートコントラクトとの相互作用を必要としない単純なEOA間転送を使用することで、送信者のプライバシー漏洩を最小限に抑えることを目指しています。「テレポーテーション」メカニズムを実現するために、Secp256k1曲線上の全ポイント集合 $E(K)$ を2つのサブセット/アドレス空間に分割します:

 - 使用可能なアドレス空間: $\\{p \in \\{0,1\\}^{160} | \exists s : keccak(s \times G)=p \lor \exists c : keccak(c_{params})=p \\}$
 - 使用不可能なアドレス空間: $\\{p \in \\{0,1\\}^{160} | \nexists s : keccak(s \times G)=p \land \nexists c : keccak(c_{params})=p \\}$

使用可能/不可能なアドレスは区別できないため、この事実を利用して、楕円曲線署名では使用できない送金先アドレスの資金の使用可能性ルールを定義することができます。ゼロ知識証明の助けを借りて、トランザクションの痕跡を隠し、新しいプライバシープロトコルを設計することができます。これがこのEIPが提案するものです。

### スケーラビリティへの影響

回路が複数の焼却分を単一のプルーフで同時に再鋳造できる場合、マーチャントやCEXはペイメントを焼却アドレスで受け取り、単一のプルーフ(およびいくつかのヌリファイアー)をブロックチェーンに保存することで、自身の資金を単一のアドレスに蓄積できるようになります。これにより、ブロックチェーン上のトランザクション数が大幅に減少します。このEIPをスケーラビリティソリューションとして使用する人々は、プロトコルのプライバシー保証も高めることになります。

## 下位互換性

ミント機能を使って生成されたイーサーは、オリジナルのイーサーと何も変わりません。人々はそれらのミントされたイーサーをガス代の支払いに使用できるはずです。

## 参考実装

参考実装はまだ用意されていませんが、以下のような設計が考えられます:

- ブロックチェーン上で発生しているすべてのETH転送(スマートコントラクトによるものを含む)を追跡し、ZK対応のスパースメルクルツリーに追加する必要があります。送信された金額もリーフに含める必要があります。
- イーサーをミントするための新しいトランザクションタイプが必要です。発起人は、メルクルツリーの特定の金額のリーフを所有していることを証明するプルーフ(ヌリファイアーとともに)を提供する必要があります。

あるいは、既存の状態トライを使用し、使用不可能なアカウントに一定量のETHが存在することを示すメルクルパトリシアトライプルーフを提供することで、ミンティングを行うこともできます。

## セキュリティ上の考慮事項

このEIPの実装に不具合がある場合、無制限のETHを鋳造してイーサリアムの価格を崩壊させる可能性があります。

## 著作権

著作権およびその関連権利は[CC0](../LICENSE.md)により放棄されています。