---
original: f5a38dee2c5c99683514bcfcdc25702d2c1348d552a0ecdeaa0ffc48e3c08914
---

---
eip: 3372
title: ethashアルゴリズムのための5つのFNVプライム
status: 停滞
type: Standards Track
category: Core
author: mineruniter969 (@mineruniter969), mineruniter969 <mineruniter969@tutanota.com>
discussions-to: https://ethereum-magicians.org/t/eip-3372-apply-minor-modifications-to-the-ethash-algorithm-to-break-current-asic-implementations-eip-969-resubmission/5655
created: 2021-03-13
---

## 簡単な要約

ethashアルゴリズムに5つの新しいFNVプライムを導入する。

## 概要

このEIPは、`fnv`定数を変更することで、現在のASIC実装をネットワークから排除し、Ethereumネットワークを安全で健全に保つことを目的としています。

## 動機

ASICは、Ethereumネットワークに深刻な集中化リスクをもたらします。ASICを排除しないと、EIP-1559により小規模なGPUマイナーがマイニングで損失を被るため、Ethereum マイニングから退出を余儀なくされます。さらに、ASIC生産は1、2の当事者に集中することになり、Ethereumのハッシュレートが集中化してしまいます。また、Ethash ASICマシンは1万ドル以上するのに対し、GPUは1,000ドル未満で価格が低いことにも注目する必要があります。

GPUの場合、マイナーは他のマイニングアルゴリズムに切り替えることができますが、ASICの場合はそれが不可能です。現状のままでは、Ethereum 2.0への移行が非常に厳しい(マイナー側から見て)ものになるでしょう。

要するに、このEIPは、ASICビジネスを排除することで、Ethereumネットワークの安定性と分散性を維持するために必要とされています。

## 仕様

`block.number >= ETHASH11_BLKNUM`の場合、`ethash1.1`アルゴリズムバージョンをアクティブにする。

### ethash1.1

この変更以前は、`hashimoto`関数全体で`fnv`ハッシュ関数が使用されていました。`fnv`は全ての手順で同一でしたが、`ethash1.1`では、追加の`fnvA`、`fnvB`、`fnvC`、`fnvD`、`fnvE`関数を導入します。これらの関数はすべて異なるFNVの定数を持ちます。

```
// 以前使用されていたFNVプライム
#define FNV_PRIME_0 0x1000193

// 新しいFNVプライム
#define FNV_PRIME_A 0x10001a7
#define FNV_PRIME_B 0x10001ab
#define FNV_PRIME_C 0x10001cf
#define FNV_PRIME_D 0x10001e3
#define FNV_PRIME_E 0x10001f9
```

このEIP導入前は、Ethashのすべての部分で`fnv`(以下`fnv0`と参照)関数が使用されていました。このEIPの導入により:
* `fnvA`が`DAGアイテム選択`ステップで`fnv0`に置き換わります
* `fnvB`が`DAGアイテムミックス`ステップで`fnv0`に置き換わります
* `fnvC(fnvD(fnvE`が`compress mix`ステップで`fnv0(fnv0(fnv0(`に置き換わります
* `DAG生成`ステップの`fnv0`は変更されません。

## 根拠

ASICマイナーはEthereum の未来に脅威となっており、ネットワークからASICを排除するためのハードフォークが必要です。EIP-3372は、それを行うための最小限の変更を提案しており、ETHステークホルダーやネットワークにはEthash 2.0のような影響を与えません。ASICが引き起こす脅威は、法的、社会的、道徳的、技術的、金銭的、環境的なものです。マージに近づくにつれ、ASICはネットワークや開発者個人を攻撃するでしょう。なぜなら、マイナーは常に利益を追求するからです。

法的および社会的には、ASICは過去に脅威や煩わしさの原因となってきました。Hudsonが述べているように、Linzhiは EIP-1057の議論中に開発者に嘘をつき、脅迫をしてきました。彼の説明は[こちら](https://github.com/Souptacular/linzhi)にあり、彼の言葉によると

> ASIC製造業者のLinzhiは、私に圧力をかけ、嘘をついてきました

下の画像のように、スタッフへの攻撃とハラスメントが行われています:
![](upload://n8TJsS8hEEH4DXYJ2WDzblm5qJo.jpeg)

社会的および道徳的に、Ethereumコミュニティは開発者への個人攻撃に対して無寛容な姿勢を取る必要があります。Ethereumの価値は開発者のおかげであり、大企業が開発者を個人的に攻撃することを許すわけにはいきません。コミュニティは各開発者を保護しなければなりません。彼らは Ethereumを維持する重要なリソースです。EIP-1057の際、複数の開発者が「傷つけられた」と言われています。マージに向けて加速するにつれ、ASIC企業が再び行動を起こし、開発者を個人的に攻撃し、法的オプションを追求する可能性が高いでしょう。これは、EIP-969の議論でも見られたように、EIP-championが脅迫を受けて降りざるを得なくなり、私がこのEIPを匿名で提出せざるを得なくなった事態と同じです。Ethereumは、その関係者が脅威なしに行動できるようにしなければなりません。これは、マージ前に強くなるASICに対して戦うよりも、今のうちに弱い状態で戦うべき戦いです。そうしないと、マージが遅れ、Ethereumの価値を損なうことになります。

ASICは、集中化したファームに所有されているため、最も悪事を働く動機と資源を持っています。これは、ビタリックがETHをASIC耐性に設計した理由です。BTC のプリンシプルである分散性を台無しにしたからです。F2Poolは主にASICファームで構成されており、ネットワークのハッシュレートの約10%を占めるようになっています。彼らのファームは、ウェブサイトで確認できます。2020年11月には23TH/sだったのが、4ヶ月後の今日では45.6 TH/sと倍増しており、さらに加速しています。追加のASICが登場するにつれ、ASICは間もなくネットワークを支配するようになるでしょう。今こそ対策を講じる必要があります。

F2PoolのようなビットコインネットワークのASICは、「悪質な行為者」として知られています。市場操縦や、BTCの価格操作のためのダンピングなどが知られています(新しいアカウントなので、ソースリンクを投稿することはできません)。マージ前に数百万ドルを失うことがわかったら、これらのASICはどのような行動をとるでしょうか。Ethereumはネットワークだけでなくコミュニティでもあり、彼らは財務的リソースを投入し、法的訴訟を繰り返すことで、マージの遅延を図るでしょう。彼らは開発者やコミュニティを攻撃し、最後の一円まで搾り取ろうとするでしょう。

EthereumがビットコインのようなASICに対抗するために設計されたのは、ビタリックがASICがネットワークに与えた被害を目の当たりにしたからです。GPUマイナーは分散化されており組織化されていないため、一つの企業の下にある倉庫ほど脅威ではありません。

EIP-3372は、環境保護にも役立ちます。マージ後、GPUは二次市場に行くか、他のコインに移行します。しかし、ASICは廃棄物になります。ASICの生産が増えれば、Ethereumの環境への負荷も増えます。これらのASICは、マージの加速が公表されているにもかかわらず、大量に生産されています。ASIC製造業者や購入者は、マージの加速を知らないか、マージの遅延を企図しているのは明らかです。ETHを売却してしまうため、ネットワークに対する利害関係はなく、トラブルを引き起こすことで1日でも長く稼ぐことができれば、そうするでしょう。

最後に、Ethereumは常に「最小発行」を追求してきました。ネットワークに脅威を与えるマイナーの数を減らすことで、Ethereumはセキュリティのための支払いを減らすことができます。EIP-1559後にマイナー収入を増やすためのEIPが準備されていますが、EIP-3372によりそのような必要性がなくなります。マージに向けて進むにつれ、コミュニティはコストを最小限に抑えるためにも、攻撃ベクトルを減らす必要があります。コミュニティはすでに保護のためにあまりにも多くを支払っており、脅威を減らすことで、その費用を削減できます。ASICの倉庫ファームはETHを全て売却しており、これがETHの価格を押し下げています。稀ではありますが、いくつかのGPUマイナーは、ステーキングに参加したり、開発やファイナンシャルな取り組みにも参加しています。つまり、彼らはASICの倉庫よりも、コミュニティにとって価値があるのです。すぐに廃棄物になるハードウェアのために、Ethereumコミュニティが支払い続ける必要はありません。

### 技術的概要

Ethash 1.1では、ハッシュ計算の段階でFNVプライムを1つから5つの新しいプライムに置き換えます。DAG生成に使用されるプライムは変更されませんが、他のすべてが変更されます。これにより、ASIC企業が新しいASICを作成することは阻止されますが、マージに近づいているため、そうする可能性は低く、仮に作成したとしても、再び脅威となるほどの量を生産することは難しいでしょう。

FNV定数の選択は、[https://tools.ietf.org/html/draft-eastlake-fnv-14#section-2.1](https://ietf)で入手可能な正式な仕様に基づいています。

このEIPの正当性を提出するのが遅れたことをお詫びします。コミュニティの皆様がご存知のように、元のチャンピオンはASIC企業からの法的攻撃のため、このEIPの作業を中止せざるを得ませんでした。私たちはこの間、彼の作業を見直し、新しいチャンピオンを見つけました。自身を守るため、私たちは匿名で提出しており、状況と脅威を考慮して、コミュニティの皆様の理解と支援をお願いします。

## 下位互換性

ethashに最適化されたマイニングハードウェアは、`fnv`定数がハードウェアに組み込まれており変更できない場合、動作しなくなる可能性があります。

## テストベクトル

```json
{
  "first": {
    "nonce": "4242424242424242",
    "mixHash": "aa6a928db9b548ebf20fc9a74e9200321426f1c2db1571636cdd3a33eb162b36",
    "header": "f901f3a00000000000000000000000000000000000000000000000000000000000000000a01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347940000000000000000000000000000000000000000a09178d0f23c965d81f0834a4c72c6253ce6830f4022b1359aaebfc1ecba442d4ea056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421b90100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008302000080830f4240808080a058f759ede17a706c93f13030328bcea40c1d1341fb26f2facd21ceb0dae57017884242424242424242",
    "
seed": "0000000000000000000000000000000000000000000000000000000000000000",
    "result": "3972318778d2af9d3c5c3dfc463bc2a5ebeebd1a7a04392708ff94d29aa18c5f",
    "cache_size": 16776896,
    "full_size": 1073739904,
    "header_hash": "2a8de2adf89af77358250bf908bf04ba94a6e8c3ba87775564a41d269a05e4ce",
    "cache_hash": "35ded12eecf2ce2e8da2e15c06d463aae9b84cb2530a00b932e4bbc484cde353"
  },
  "second": {
    "nonce": "307692cf71b12f6d",
    "mixHash": "4a2ef8287dc21f5def0d4e9694208c56e574b1692d7b254822a3f4704d8ad1ba",
    "header": "f901f7a01bef91439a3e070a6586851c11e6fd79bbbea074b2b836727b8e75c7d4a6b698a01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d4934794ea3cb5f94fa2ddd52ec6dd6eb75cf824f4058ca1a00c6e51346be0670ce63ac5f05324e27d20b180146269c5aab844d09a2b108c64a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421b90100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008302004002832fefd880845511ed2a80a0e55d02c555a7969361cf74a9ec6211d8c14e4517930a00442f171bdb1698d17588307692cf71b12f6d",
    "seed": "0000000000000000000000000000000000000000000000000000000000000000",
    "result": "5ab98957ba5520d4e367080f442e37a047cfd9d2857b6e00dd12d82900d108a6",
    "cache_size": 16776896,
    "full_size": 1073739904,
    "header_hash": "100cbec5e5ef82991290d0d93d758f19082e71f234cf479192a8b94df6da6bfe",
    "cache_hash": "35ded12eecf2ce2e8da2e15c06d463aae9b84cb2530a00b932e4bbc484cde353"
  }
}
```

## セキュリティ上の考慮事項

この変更に知られているセキュリティ上の問題はありません。

## 著作権

著作権およびそれに関連する権利は[CC0](../LICENSE.md)により放棄されています。