---
original: f571a966a6cc95e0b66466fbf27017bbd6984561890be88356098a8d2d2b890e
---

---
eip: 2029
title: State Rent A - State counters contract
author: Alexey Akhunov (@AlexeyAkhunov)
discussions-to: https://ethereum-magicians.org/t/eip-2029-state-counters-contract-change-a-from-state-rent-v3-proposal/3279
status: Stagnant
type: Standards Track
category: Core
created: 2019-05-15
---

## 簡単な要約
すべてのイーサリアムネットワークにデプロイされる、事前に決められたアドレスのスマートコントラクトには、唯一のパラメーターによって指定されたストレージスロットを読み取るコードが含まれています。その後、このコントラクトは「特別」になり、イーサリアムがそのコントラクトにさまざまな状態カウンターを書き込むようになります。

## 概要
これは State Rent ロードマップの一部です。この特定の変更では、さまざまな状態カウンターを格納できる場所をイーサリアムの状態に導入します。現時点で最も重要なカウンターは、これまでに発生したトランザクションの総数であり、このカウンターを使用して、新しく作成された非コントラクトアカウントのnonce値を設定します。このようにnonceを設定することで、退出して後に Ether を送信することで復活したアカウントに対するリプレイ保護が確保されます。

## 動機
現在、イーサリアムには、トランザクション数やアカウント数などの状態カウンターを追跡するための特別な場所がありません。

## 仕様
ブロックAの前に、次のコードを持つコントラクトがデプロイされます:
`0x60 0x20 0x60 0x00 0x80 0x80 0x35 0x54 0x90 0x52 0xF3`。これは次のアセンブリに対応しています:
`PUSH1 32 PUSH1 0 DUP1 DUP1 CALLDATALOAD SLOAD SWAP1 MSTORE RETURN`
このコントラクトへの呼び出しは 32 バイトの引数 `x` を受け取り、ストレージアイテム [`x`] の値を返します。

このコントラクトは `CREATE2` オペコードを使用してデプロイされ、どのネットワークでも同じアドレスを持つようになります。

## 根拠
これまでに2つの代替案が検討されています:
1. イーサリアムの状態の構造を拡張して、より多くのフィールドを導入し、状態ルートの構築方法を変更すること。この方法の主な欠点は、状態ルートの構築方法に結び付けられているソフトウェアへの影響です。特に、状態ルートから派生するメルクルプルーフを処理するソフトウェアに影響があります。
2. 拡張状態オラクル ([EIP-2014](./eip-2014.md))。このような提案の下では、標準化されたインターフェイスを持つプリコンパイルコントラクトがあり、現在のカウンター値を返すことができます。ただし、そのようなオラクルが返すデータは状態に明示的に存在せず、メルクル化されていません。つまり、スナップショットの同期時にすべてのカウンターをスナップショットに追加する必要があり、それでも状態に暗黙的に存在することになります。

## 下位互換性
この変更は下位互換性があり、アクティブ化するためのハードフォークは必要ありません。

## テストケース
状態カウンターコントラクトがそのストレージアイテムを正しく返すことを確認するためのテストケースが作成されます。

## 実装
実装は、任意のイーサリアムアドレスから投稿できるトランザクションとして想定されており、それによって状態カウンターコントラクトがデプロイされます。

## 著作権
著作権およびそれに関連する権利は [CC0](../LICENSE.md) で放棄されています。