---
original: 051dbf9ec2204373c709ecaab5a38e938af2a2df3252484f8f59cfad27276793
---

---
eip: 3300
title: リファンドの段階的廃止
author: William Morriss (@wjmelements)
discussions-to: https://ethereum-magicians.org/t/eip-3300-phase-out-refunds/5434
status: 停滞
type: Standards Track
category: Core
created: 2020-02-26
---

## 簡単な要約
`SSTORE`と`SELFDESTRUCT`のガスリファンドを段階的に廃止します。

## 概要
このEIPでは、`SSTORE`と`SELFDESTRUCT`のリファンドが減少し始める時期を定義します。
リファンドは線形的に減少し、そのような refunds の暗黙的な価値が加速度的に減少します。

## 動機
リファンドはブロックの弾力性を高めるため、ブロックガスターゲットは鉱夫が設定した数値の2倍まで超えることができます。
これにより、鉱夫がブロックガスターゲットを引き上げることを躊躇する可能性があります。

トークン化されているかどうかに関わらず、リファンドは所有者にとって特に混雑時に価値があります。
リファンドを完全に廃止する必要がある場合、段階的な変化はガス市場に対して突然の廃止よりも影響が小さくなります。
リファンドの消費は、特に混雑時に進行し、状態からリファンドがクリーンアップされます。
需要によって駆動されるリファンドの作成は、リファンドの効率性が低下するにつれて自然に減少します。
リファンドの価値が起動コストに近づくにつれ、リファンドの暗黙的な価値はゼロに近づきますが、混雑時にはクリーンアップされます。

このような変更は、補償とクリーンアップよりもプロトコル開発者にとって作業が少なく、おそらくクリーンアップを達成できるでしょう。

## 仕様
パラメーター:
* `FORK_BLOCK_NUM`: EIP-3300の有効化ブロック
* `REFUND_DECAY_STEP`: 1 gas
* `REFUND_DECAY_FREQUENCY`: 100 blocks

計算:
* `REFUND_DECAY`: `REFUND_DECAY_STEP * ceil((block.number + 1 - FORK_BLOCK_NUM) / REFUND_DECAY_FREQUENCY)`

このEIPが有効になるブロックと、その後の`REFUND_DECAY_FREQUENCY`ブロックごとに、`SELFDESTRUCT`と`SSTORE`を含むすべてのガスリファンドが`REFUND_DECAY_STEP`ずつ減少し、最終的にゼロになります。
現在の差額は`REFUND_DECAY`と呼ばれ、各ガスリファンドから減算されます。

リファンドの削除によって前のリファンドがキャンセルされるガスコストレジームでは、リファンドカウンターがマイナスにならないという不変条件が、`REFUND_DECAY`によってそれらの削除の大きさを減少させることで維持されます。

### EIP-2929
EIP-2929のリファンドは以下の通りです:

* SELFDESTRUCT: 24000
* `SSTORE_RESET_GAS - SLOAD_GAS` (5000 - 100)
* `SSTORE_SET_GAS - SLOAD_GAS` (20000 - 100)
* `SSTORE_SET_GAS - SLOAD_GAS` (20000 - 100)
* `SSTORE_CLEARS_SCHEDULE` (15000)

これらのリファンドはすべて、現在の`REFUND_DECAY`によって減少します。

また、`SSTORE_CLEARS_SCHEDULE`がリファンドカウンターから削除される場合もあります。
その削除も`REFUND_DECAY_STEP`によって0まで減少し、リファンドカウンターの非負の不変条件が維持されます。

## 根拠
永続化されたリファンドは、起動コストを下回る前に無価値になります。
リファンドが無価値になったら、待つことなく別のハードフォークで削除できます。
指定された減少率では、現在`SELFDESTRUCT`は(24000-5000) * 100 = 1,900,000ブロック、`SSTORE`は(15000-5000) * 100 = 1,000,000ブロックで必要です。
この期間は現在約1年で、残りのリファンドを消費するのに十分な柔軟性があるはずです。

## 下位互換性
この提案はガスリファンドを破壊し、ブロックの弾力性に影響します。
その結果、ガス価格の変動性が高くなります:より高い最高値とより低い最低値。

ガスカウンターとは別にリファンドカウンターがあるため、ブロック間のガスの変化は`eth_estimateGas`を壊しません。

## 著作権
著作権およびそれに関連する権利は[CC0](../LICENSE.md)によって放棄されています。