---
original: fc8449b5e17262eb92b64cb0429ced9853975132e6e03e289db522c5d78849dc
---

---
eip: 1285
title: CALL オペコードの Gcallstipend ガスの増加
author: Ben Kaufman <ben@daostack.io>, Adam Levi <adam@daostack.io>
discussions-to: https://ethereum-magicians.org/t/eip-1285-increase-gcallstipend-gas-in-the-call-opcode/941
status: 停滞
type: Standards Track
category: Core
created: 2018-08-01
---

## 簡単な要約
``CALL`` オペコードの ``Gcallstipend`` 料金パラメータを ``2,300`` から ``3,500`` ガスユニットに増やします。

## 概要
現在、``CALL`` オペコードは、ゼロ以外の値の ``CALL`` 操作でコントラクトが呼び出される場合、``2,300`` ガスユニットのスティペンドを転送します。このスティペンドは、コントラクトの ``fallback`` 関数の実行を可能にするために与えられます。このスティペンドは意図的に小さく設定されており、呼び出されたコントラクトがコールガスを使い果たしたり、攻撃(再入力など)を行うのを防ぐためです。
スティペンドは小さいものの、``LOG`` などの安価なオペコードの実行には十分な量を提供しますが、より複雑で最新のロジックを実装するには不十分です。
このEIPでは、``fallback`` 関数の使いやすさを高めるため、スティペンドを ``2,300`` から ``3,500`` に増やすことを提案します。

## 動機
このEIPの主な動機は、``"Proxy"`` パターンに従うコントラクトの簡単な ``fallback`` 関数を実装できるようにすることです。簡単に説明すると、``"Proxy Contract"`` は、その ``fallback`` 関数で ``DELEGATECALL`` を使用して、別のコントラクトのロジックに従って動作し、そのコントラクトのロジックの独立したインスタンスとして機能するコントラクトです。
このパターンは、デプロイごとのガス節約(Proxyコントラクトはとてもスリムです)に非常に役立ち、コントラクトの更新可能性を実現します。
平均して、プロキシコントラクトの ``DELEGATECALL`` 機能には約 ``1,000`` ガスユニットが必要です。
コントラクトがETHをプロキシコントラクトに転送すると、プロキシロジックが約 ``1,000`` ガスユニットを消費してから、ロジックコントラクトの ``fallback`` 関数が実行されます。これにより、ロジックの実行に残されるのは僅か約 1,300 ガスユニットです。これは深刻な制限であり、平均的な ``LOG`` 操作(1つのパラメータの ``LOG`` であれば十分かもしれません)を行うのに十分ではありません。
スティペンドのガスユニットをわずかに増やすことで、プロキシコントラクトが適切な ``fallback`` ロジックを持つことができ、呼び出し元のコントラクトの攻撃対象面積を増やすことなく済みます。

## 仕様
``CALL`` オペコードの ``Gcallstipend`` 料金パラメータを ``2,300`` から ``3,500`` ガスユニットに増やします。
Ethereumクライアントへの実際の変更は、定数として保存されている ``CallStipend`` を変更することになります。
実装例として、Gethクライアントの実装は[こちら](https://github.com/ben-kaufman/go-ethereum/tree/eip-1285)にリンクされています。コードへの実際の変更は[こちら](https://github.com/ben-kaufman/go-ethereum/blob/eip-1285/params/protocol_params.go#L41)にあります。

## 根拠
``Gcallstipend`` ガスパラメータを ``1,200`` ガスユニット増やす根拠は、``DELEGATECALL`` と ``SLOAD`` の実行コストに、少量の追加操作のマージンを加えたものです。それでも、スティペンドは比較的小さく、ストレージへのアクセスや状態の変更には不十分なままです。

## 下位互換性
このEIPでは、``CALL`` オペコードの ``Gcallstipend`` ガスパラメータに下位互換性のない変更が必要です。

## 著作権
[CC0](../LICENSE.md)によりワイバーされた著作権およびそれに関連する権利。