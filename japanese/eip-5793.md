---
original: 1dcf6c3fffa50c5fdd35d9b6570f24d957cec84192c6f197d71505775e199cbb
---

---
eip: 5793
title: eth/68 - トランザクション タイプをトランザクション アナウンスに追加する
description: ワイヤープロトコルのトランザクション アナウンス メッセージにトランザクション タイプとトランザクション サイズを追加する
author: Marius van der Wijden (@MariusVanDerWijden)
discussions-to: https://ethereum-magicians.org/t/eip-5793-eth-68-add-transaction-type-to-tx-announcement/11364
status: 最終
type: 標準トラック
category: ネットワーキング
created: 2022-10-18
requires: 2464, 2481, 4938
---

## 概要

Ethereumワイヤープロトコルは、クライアント間でデータを交換するためのリクエストとレスポンスメッセージを定義しています。 `NewPooledTransactionHashes`メッセージは、ノードで利用可能なトランザクションをアナウンスします。 このEIPは、トランザクションハッシュに加えて、ノードがトランザクションタイプとサイズ([EIP-2718](./eip-2718.md)で定義)も送信するように、このアナウンスメッセージを拡張します。

## 動機

`NewPooledTransactionHashes`メッセージはトランザクションハッシュをアナウンスし、ピアがまだ持っていないトランザクションを選択的にフェッチできるようにします。

[EIP-4844](./eip-4844.md)は、ブロブトランザクション用の新しいトランザクションタイプを導入しました。これらのブロブトランザクションは大きいため、 `sqrt(peers)`にナイーブにブロードキャストすると、帯域幅要件が大幅に増加する可能性があります。トランザクションタイプとサイズをアナウンスメッセージに追加すると、ノードはどのトランザクションをフェッチするかを選択でき、過去の動作に基づいてピアをロードバランシングまたスロットリングすることもできます。

追加のメタデータフィールドにより、特定のトランザクションタイプ(例えばブロブトランザクション)や特定のトランザクションサイズ(例えば128KB以上)をブラインドブロードキャストから防ぐための、将来のアップグレードなしのプロトコルの調整も可能になります。アナウンスのみと要求に応じたリトリーブを強制することで、トランザクション伝播DoS攻撃の増幅効果を大幅に抑えることができます。

## 仕様

`NewPooledTransactionHashes (0x08)`メッセージを変更する:

* **(eth/67)**: `[hash_0: B_32, hash_1: B_32, ...]`
* **(eth/68)**: `[types: B, [size_0: P, size_1: P, ...], [hash_0: B_32, hash_1: B_32, ...]]`

新しい `types` 要素は、アナウンスされたハッシュのトランザクションタイプを示します。トランザクションタイプは'バイト配列'としてパックされていることに注意してください。

`size_0`、`size_1`などの要素は、アナウンスされたハッシュのトランザクションサイズを示します。

## 根拠

この変更により、`eth`プロトコルは、すべてのノードに関連しない可能性のある新しいトランザクションタイプに対して将来対応できるようになります。受信ノードがピアから取得するデータをより良く制御でき、特定のタイプのダウンロードをスロットリングすることもできます。

`types`メッセージ要素がバイト配列になっているのは、このEIPの初期実装がそのように誤って実装していたためです。その後、作業を最小限に抑えるためにこの動作を維持することが決定されました。

## 下位互換性

このEIPは`eth`プロトコルを変更し、新しいバージョン`eth/68`のリリースが必要です。ワイヤープロトコルの複数のバージョンをサポートすることは可能です。新しいバージョンをリリースしても、古いクライアントは直ちに壊れることはありません。なぜなら、プロトコルバージョン`eth/67`を継続して使用できるためです。

このEIPはEVMのコンセンサスルールを変更せず、ハードフォークを必要としません。

## セキュリティ上の考慮事項

なし

## 著作権

[CC0](../LICENSE.md)によりワイバーされた著作権およびそれに関連する権利。