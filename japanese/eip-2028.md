---
original: 765afb0a066eb847eccaa02726cefa2995f1b6a0e13564936219eed1a8123e88
---

---
eip: 2028
title: トランザクションデータのガスコスト削減
author: Alexey Akhunov (@AlexeyAkhunov), Eli Ben Sasson <eli@starkware.co>, Tom Brand <tom@starkware.co>, Louis Guthmann <louis@starkware.co>, Avihu Levy <avihu@starkware.co>
discussions-to: https://ethereum-magicians.org/t/eip-2028-calldata-gas-cost-reduction/3280
status: 最終
type: 標準トラック
category: コア
created: 2019-05-03
---

## 簡単な要約
Calldata (`GTXDATANONZERO`) のガスコストを現在の68ガスから16ガスに削減することを提案します。これは数学的モデリングと経験的な推定に基づいて行います。数学モデルは、Sompolinsky and Zohar [1] およびPass、Seeman、Shelat [2] の研究で使用されているものです。これは、ネットワークの遅延とネットワークのセキュリティの関係を示しています。我々は以下を行います: (1) このモデルを使ってCalldata ガスコストの低下がネットワーク遅延に与える理論的影響を評価する、(2) モデルを経験的に検証する、(3) 調査結果に基づいて提案されるガスコストを決定する。

## 動機
この提案を受け入れてCalldata のガスコストを引き下げることには以下のような主な利点があります。
オンチェーンのスケーラビリティ: 一般的に、Calldata の帯域幅が高いほどスケーラビリティが向上し、1つのブロックに多くのデータを収容できるようになります。
* レイヤー2のスケーラビリティ: レイヤー2のスケーリングソリューションは、ストレージと計算をオフチェーンに移すことでスケーラビリティを向上させることができますが、その代わりにデータ送信が必要になります。
	- STARKsやSNARKsなどの証明システムは、大量のトランザクション処理を行う大規模な計算の計算整合性を保証する単一の証明を使用します。
	- 一部のソリューションは不正検知証明を使用し、メルクルプルーフの送信が必要になります。
	- さらに、レイヤー2のデータ可用性ソリューションの1つとして、Calldataを使ってメインチェーンにデータを配置することができます。
* ステートレスクライアント: 同じモデルを使って、ステートレントクライアントレジームのための状態アクセスの価格を決定することができます。そこでは、ブロックプルーフの送信に必要な帯域幅の増加と、それらのブロックプルーフを検証するための追加の処理に比例してガスコストが増加すると予想されています。

## 仕様
非ゼロバイトあたりのガスコストは68から16に削減されます。ゼロバイトのガスコストは変更されません。

## 根拠
大まかに言えば、Calldataのガスコストを下げると、ブロックサイズが大きくなる可能性があり、これによってネットワーク上のデータ送信に関連するネットワーク遅延が増加します。これはネットワーク遅延の全体的な要因の一部に過ぎず、他の要因としてはブロック処理時間(およびその一部としての状態アクセス)があります。ネットワーク遅延の増加は、ブロックチェーンの最新の状態を更新されたノードが少なくなるため、ネットワークへの攻撃コストを引き下げることで、セキュリティに影響を与えます。

Yonatan Sompolinsky とAviv Zohar は[1]で、ネットワーク遅延とネットワークのセキュリティの関係を示す優れたモデルを提案しており、Rafael Pass、Lior Seeman、Abhi Shelat [2]の研究でも同じモデルが使用されています。以下でこのモデルを簡単に説明しますが、理論的に研究し、経験的な測定によって検証して、Calldataの提案されるより低いガスコストに到達します。

このモデルでは以下のような自然なパラメータを使用しています:
* _lambda_ はブロック生成レート[1/s]: PoW解の発見プロセスをポアソン過程と扱い、レート _lambda_ で行われます。
* _beta_ - チェーン成長レート[1/s]: 最長チェーンに新しいブロックが追加される速度。
* _D_ - ブロック遅延[s]: 新しいブロックの採掘と、すべてのマイナーによるそのブロックの受け入れ(すべてのマイナーがそのブロックの上に採掘を開始する)までの時間。

### _Beta_ の下限
_lambda_ >= _beta_ であることに注意が必要です。これは、発見されたすべてのブロックがメインチェーンに入るわけではないためです(叔父ブロックの場合など)。[1]では、最長チェーンルールを使うブロックチェーンについて、_beta_ を _lambda_/ (1+ D * _lambda_) 以上と下限を示しています。この下限は、ネットワークのトポロジーが完全グラフで、各ノード間の遅延がDの最大値の場合に成り立ちます。_beta_ の上限と下限を記録すると以下のようになります。

	_lambda_ >= _beta_ >= _lambda_ / (1 + D * _lambda_)               (*)

D=0の場合、つまり遅延がない場合は _beta_ が _lambda_ に等しくなるのは当然のことです。

### ネットワークのセキュリティ
メインチェーンを再編成しようとする攻撃者は、_beta_ を上回るレートでブロックを生成する必要があります。
PoWパズルの難易度を固定すると、システム全体のハッシュレートは _lambda_ に相関しています。したがって、_beta_ / _lambda_ はシステムの*効率*を表し、メインチェーンの生成に使用されるハッシュパワーの割合を示します。

(*)を書き換えると、遅延に関する効率の下限が以下のように得られます:

	_beta_ / _lambda_ >= 1 / (1 + D * _lambda_)                 (**)

### _遅延_パラメータD
ネットワーク遅延は、マイニングノードのネットワーク内の位置と現在のネットワークトポロジー(動的に変化する)に依存するため、直接測定するのは比較的難しいです。
以前、Christian Decker とRoger Wattenhofer [3] は、伝播時間がブロックサイズに比例することを示し、Vitalik Buterinは効率(**) の尺度と密接に関連するおじいレートもブロックサイズに比例することを示しました[4]。

ただし、遅延関数は _D_t_ と _D_p_ の2つの部分に分解できます。_D_t_ はブロックの送信による遅延で、_D_p_ はノードによるブロックの処理による遅延です。我々のモデルとテストでは、_D_t_ と _D_p_ がそれぞれ異なる影響を及ぼすことを検討します。これは特に、レイヤー2のスケーラビリティとステートレスクライアント(動機2、3)に関連して重要かもしれません。これらの目的に関連するCalldata の大部分はメルクルの認証パスであり、_D_p_ の値は比較的小さいが _D_t_ の要素が大きいためです。

## テストケース
Calldataのガスコストを提案するために、2種類のテストを行います:
1. メインネットで行うネットワークテスト。ブロックサイズの増加が _D_p_ と _D_t_、全体的なネットワーク遅延Dおよび効率比(**) に与える影響を推定するためのものです。また、さまざまなマイニングプールの間の遅延も測定します。これらのテストには、既存のデータに対する回帰テストと、極端なシナリオを導入するためのストレステストが含まれます。
2. 単一ノードで行うローカルテスト。Calldataの量と一般的な計算制限に応じた処理時間を測定するものです。

## 参考実装
[Parity](https://github.com/liorgold2/parity-ethereum/pull/1)
[Geth](https://github.com/liorgold2/go-ethereum/pull/1)

## 参考文献
[1] Yonatan Sompolinsky, Aviv Zohar: [Secure High-Rate Transaction Processing in Bitcoin](https://eprint.iacr.org/2013/881.pdf). Financial Cryptography 2015: 507-527

[2] Rafael Pass, Lior Seeman, Abhi Shelat: [Analysis of the Blockchain Protocol in Asynchronous Networks](https://eprint.iacr.org/2016/454.pdf), ePrint report 2016/454

[3] Christian Decker, Roger Wattenhofer: [Information propagation in the Bitcoin network](https://www.gsd.inesc-id.pt/~ler/docencia/rcs1314/papers/P2P2013_041.pdf). P2P 2013: 1-10

[4] Vitalik Buterin: [Uncle Rate and Transaction Fee Analysis](https://blog.ethereum.org/2016/10/31/uncle-rate-transaction-fee-analysis/)

## 著作権
著作権およびその関連権利は[CC0](../LICENSE.md)により放棄されています。