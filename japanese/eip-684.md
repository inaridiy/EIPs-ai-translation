---
original: b53f3a71e47169d295c16018498ed64b57aa67486db7adf3f5e6ffb7ab542b4b
---

---
eip: 684
title: 衝突の場合の作成の取り消し
description: アドレスにすでにコードがある場合、コントラクトの作成を取り消す
author: Vitalik Buterin (@vbuterin), Renan Rodrigues de Souza (@RenanSouza2)
discussions-to: https://ethereum-magicians.org/t/eip-revert-on-address-collision/13442
status: 最終
type: 標準トラック
category: コア
created: 2023-03-20
---

## 概要

このEIPは、既存のコードを持つアドレスでコントラクトの作成を行うと、エラーが発生するようにします。これにより、コントラクトコードを展開し、後でそのアドレスで任意のコードに変更するという攻撃を防ぐことができます。

## 仕様

この文書の中の「MUST」、「MUST NOT」、「REQUIRED」、「SHALL」、「SHALL NOT」、「SHOULD」、「SHOULD NOT」、「RECOMMENDED」、「NOT RECOMMENDED」、「MAY」、「OPTIONAL」というキーワードは、RFC 2119およびRFC 8174に記載されているように解釈されるものとします。

作成トランザクション、`CREATE`オペコード、`CREATE2`オペコード、またはその他の理由によりコントラクトの作成が試行され、宛先アドレスにすでにゼロ以外のnonce、またはゼロ以外のコード長がある場合、作成は初期化コードの最初のバイトが無効なオペコードであるかのようにスローされなければなりません(MUST)。この変更は、既存のすべてのブロックに遡って適用されなければなりません(MUST)。

## 根拠

スマートコントラクトの根本的な原則の1つは、そのコードは変更されないということです。しかし、十分な計算能力があれば、攻撃者はアドレスに格納されているコードを任意のコードに変更し、資金を盗んだり、その他の悪意のある活動を実行したりすることができます。

## 下位互換性

これは実行レイヤーのアップグレードであるため、ハードフォークが必要です。

## テストケース

次のようなジェネシス割り当てがある場合:

```
アドレス: 0xd0bBEc6D2c628b7e2E6D5556daA14a5181b604C5,
残高: 1000000000000000000, // 1 ether
Nonce: 0,
コード: "",

アドレス: 0x7658771dc6Af74a3d2F8499D349FF9c1a0DF8826,
残高: 0,
Nonce: 1,
コード: "0xB0B0FACE",
```

EOA `0xd0bBEc6...`(`227bcc6959669226360814723ed739f1214201584b6a27409dfb8228b8be5f59`)から最初のトランザクションで作成されたコントラクトは、ソルトなしで作成しようとすると、取り消されるべきです。

## セキュリティ上の考慮事項

このEIPはセキュリティアップグレードです。展開されたコードの不変性を強制します。

## 著作権

著作権およびそれに関連する権利は[CC0](../LICENSE.md)により放棄されています。