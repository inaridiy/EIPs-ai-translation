---
original: a56f068efaf2b0f13882b91808d9988719c49e70f774249b98bfebf491a6adad
---

---
eip: 3788
title: chainIdの厳格な適用
description: ノードの設定と同じchainIdを明示的に持たないトランザクションを拒否する。
author: Gregory Markou (@GregTheGreek)
discussions-to: https://ethereum-magicians.org/t/discussion-to-eip-3788-strict-enforcement-of-chainid/7001
status: 停滞
type: Standards Track
category: Core
created: 2021-09-02
requires: 155
---

## 概要

ノードの設定と同じchainIdを明示的に持たないトランザクションを拒否する。

## 動機

[EIP-155](./eip-155.md)によると、`chainId = 0`のトランザクションは有効なトランザクションとみなされます。これは開発者がさまざまなチェーン間でリプレイ可能なトランザクションを送信できるようにする機能でした。しかし、EVMと互換性のある多くのチェーンが登場し、それらの多くがフォークやポピュラーなEthereumクライアントのパッケージを使用するようになったため、ユーザーの資金が危険にさらされています。これは、ほとんどのウォレットインターフェイスがchainIdをユーザーに公開していないため、ユーザーが自分が署名しているchainIdを通常把握していないためです。悪意のある行為者(または偶発的な)が、`chainId = 0`のトランザクションをnon-mainnetネットワークで送信し、それをEthereum mainnet(または他のネットワーク)で再生することで、悲しみや高度な攻撃を行うことができます。

## 仕様

フォークブロック `N`以降、`chaindId = 0`のトランザクションを無効と見なします。つまり、トランザクションはノードの設定に基づいて検証されます。例:
```
if (node.cfg.chainId != tx.chainId) {
    // トランザクションを拒否
}
```

## 根拠

ノードによって設定された構成が真の情報源であり、したがってトランザクションをフィルタリングする際にこれを明示的に使用する必要があります。このチェックは2つの場所に存在する必要があります。1つはJSON-RPC(例: `eth_sendTransaction`)でのフィルタリング、もう1つはトランザクション検証時のEVM内での厳格な適用です。

これにより、保留中のトランザクションが確実に失敗するのを防ぐことができ、ブロックにトランザクションが含まれるのを防ぐことができます。

## 下位互換性
これにより、ブロック番号 `N` 以降に `chainId == 0` のトランザクションを送信するすべてのアプリケーションやツールが破壊されます。

## テストケース
TBD

## セキュリティ上の考慮事項
これは、悪意のある行為者が `chainId = 1` のネットワークを展開したり、他のネットワークのchainIdをコピーしたりするのを防ぐことはできません。

## 著作権
[CC0](../LICENSE.md)によりワイバーされた著作権およびそれに関連する権利。