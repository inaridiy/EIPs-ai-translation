---
original: 377658cd2a5a0dd2bca7de98acc46aa6aeecad336d4bc7c17c715c3c2683680a
---

---
eip: 3326
title: ウォレットのイーサリアムチェーンRPCメソッドの切り替え (`wallet_switchEthereumChain`)
author: Erik Marks (@rekmarks)
discussions-to: https://ethereum-magicians.org/t/eip-3326-wallet-switchethereumchain
status: 停滞
type: Standards Track
category: Interface
created: 2021-03-04
requires: 155, 695
---

## 簡単な要約

ウォレットのアクティブなイーサリアムチェーンを切り替えるためのRPCメソッド。

## 概要

`wallet_switchEthereumChain` RPCメソッドは、イーサリアムアプリケーション("dapps")がウォレットのアクティブなイーサリアムチェーンを切り替えるよう要求できるようにします。
呼び出し側はチェーンIDを指定する必要があります。
ウォレットアプリケーションは、要求を任意に拒否または受け入れることができます。
アクティブなチェーンが切り替わった場合は`null`が返され、それ以外の場合はエラーが返されます。

このメソッドの実装者向けの重要な注意事項は、[セキュリティ上の考慮事項](#セキュリティ上の考慮事項)セクションに記載されています。

## 動機

すべてのdappsは、機能するためにユーザーが1つ以上のイーサリアムチェーンと対話する必要があります。
一部のウォレットは、1つのチェーンとのみ対話することができます。
これをウォレットの"アクティブチェーン"と呼びます。
`wallet_switchEthereumChain`は、dappがウォレットのアクティブチェーンをdappが必要とするチェーンに切り替えるよう要求できるようにします。
これにより、dappsとウォレットの両方のユーザーエクスペリエンスが向上します。

## 仕様

この文書の中の "MUST"、"MUST NOT"、"REQUIRED"、"SHALL"、"SHALL NOT"、"SHOULD"、"SHOULD NOT"、"RECOMMENDED"、"MAY"、"OPTIONAL" というキーワードは、[RFC-2119](https://www.ietf.org/rfc/rfc2119.txt)に記載されている通りに解釈されるものとします。

### `wallet_switchEthereumChain`

このメソッドは、`chainId`フィールドを持つ単一のオブジェクトパラメーターを受け入れます。
メソッドは、ウォレットがアクティブチェーンを切り替えた場合は`null`を返し、それ以外の場合はエラーを返します。

このメソッドは、ウォレットが単一の"アクティブチェーン"の概念を持っていることを前提としています。
アクティブチェーンは、ウォレットがRPCリクエストをフォワーディングしているチェーンと定義されます。

#### パラメーター

`wallet_switchEthereumChain`は、以下のTypeScriptインターフェースで指定された単一のオブジェクトパラメーターを受け入れます:

```typescript
interface SwitchEthereumChainParameter {
  chainId: string;
}
```

フィールドがこの仕様の要件を満たしていない場合、ウォレットは**MUST**リクエストを拒否しなければなりません。

- `chainId`
  - **MUST**16進数文字列で表されるチェーンのIDを指定する必要があります。[`eth_chainId`](./eip-695.md) Ethereum RPCメソッドに従います。
  - チェーンIDは、ウォレットに既知でなければなりません。
  - ウォレットは、指定されたチェーンに切り替えて、そのチェーンのRPCリクエストに対応できなければなりません。

#### 返り値

メソッドは、リクエストが成功した場合は`null`を返さなければならず、それ以外の場合はエラーを返さなければなりません。

ウォレットがアクティブチェーンの概念を持っていない場合、ウォレットは**MUST**リクエストを拒否しなければなりません。

### 例

これらの例ではJSON-RPCを使用していますが、このメソッドは他のRPCプロトコルでも実装できます。

メインネットに切り替える:

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "method": "wallet_switchEthereumChain",
  "params": [
    {
      "chainId": "0x1",
    }
  ]
}
```

Goerliテストチェーンに切り替える:

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "method": "wallet_switchEthereumChain",
  "params": [
    {
      "chainId": "0x5",
    }
  ]
}
```

## 根拠

`wallet_switchEthereumChain`の目的は、ユーザーに手動で行わせるのではなく、dappsがウォレットのアクティブチェーンを切り替えるよう要求できるようにすることです。

メソッドは単一のオブジェクトパラメーターを受け入れるため、実装者と消費者にほとんどコストをかけずに将来の拡張性を持つことができます。

関連する取り組みとしては、[EIP-3085: `wallet_addEthereumChain`](./eip-3085.md)と[EIP-2015: `wallet_updateEthereumChain`](./eip-2015.md)があります。
`wallet_switchEthereumChain`は、アクティブチェーンの切り替えに関係するRPCエンドポイントやその他のメタデータとは無関係に、純粋にアクティブチェーンの切り替えを行うことを意図しているため、それらのEIPに含まれるチェーンメタデータパラメーターを意図的に省略しています。

## セキュリティ上の考慮事項

アクティブチェーンの概念を持つウォレットにとって、アクティブチェーンの切り替えは、保留中のRPCリクエストやユーザーエクスペリエンスに大きな影響を及ぼします。
ユーザーの認識なしにアクティブチェーンが切り替わると、dappがユーザーに意図しないチェーンでアクションを取らせる可能性があります。

このため、ウォレットは以下のことを行うべきです:

- `wallet_switchEthereumChain`を受信するたびに、要求元とスイッチ先のチェーンを明確に識別する確認画面を表示する。
  - [EIP-1102](./eip-1102.md)で使用されている確認画面が参考になるかもしれません。
- アクティブチェーンを切り替える際は、保留中のすべてのRPCリクエストとチェーン固有のユーザー確認を取り消す。

### ユーザープライバシーの保護

サポートされていないチェーンや、まだウォレットに追加されていないチェーンへの要求を自動的に拒否することで、要求者がウォレットでサポートされているチェーンを推測できるようになります。
ウォレットの実装者は、このコミュニケーションチャネルがウォレットのセキュリティ特性に違反するかどうかを検討し、必要に応じて適切な緩和策を講じるべきです。

## 著作権

著作権およびそれに関連する権利は[CC0](../LICENSE.md)によって放棄されています。