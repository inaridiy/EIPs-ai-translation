---
original: b15d0ba785a143292c545a39cc7bb49e870bf030546f9934767904ba41169a73
---

---
eip: 7708
title: ETH転送にログが出力される
description: すべてのETH転送にログが出力される
author: Vitalik Buterin (@vbuterin), Peter Davies (@petertdavies)
discussions-to: https://ethereum-magicians.org/t/eip-7708-eth-transfers-emit-a-log/20034
status: Draft
type: Standards Track
category: Core
created: 2024-05-17
---

## 概要

トランザクション、`CALL`、`SELFDESTRUCT`を含むすべてのETH転送にログが出力されます。

## 動機

ログはしばしばEthereumのアセットの残高変更を追跡するために使用されます。ログは[ERC-20](./eip-20.md)トークンでは機能しますが、ETHでは機能しません。EOAからのETH転送はブロックのトランザクションリストから読み取ることができますが、スマートコントラクトウォレットからのETH転送は自動的にどこにもログ記録されません。これは過去に問題を引き起こしています。例えば、初期の取引所はスマートコントラクトウォレットからの入金をうまくサポートしていなかったり、大幅に遅延してサポートしていただけでした。このEIPでは、値を転送する`CALL`または`SELFDESTRUCT`が発生するたびに自動的にログを生成することを提案します。また、トランザクションでの転送にも同様のログを追加し、すべてのETH転送を1つのメカニズムで追跡できるようにします。

## 仕様

### パラメータ

* `MAGIC`: `TBD`

### 機能

(i)ゼロ以外の値の`CALL`、(ii)ゼロ以外の値を転送する`SELFDESTRUCT`、または(iii)ゼロ以外の値を転送するトランザクションが発生するたびに、3つのトピック(i) `MAGIC`、(ii)送信者アドレス、(iii)受信者アドレスを持つLOG3と同一のログを発行します。ログデータは、転送値を32バイトのビッグエンディアンエンコーディングしたものです。

値を転送するトランザクションの`LOG`は、EVM実行によって生成されるログの前に配置されます。他の2つの`LOG`は、値の転送が実行されるときに配置されます。

## 根拠

これは、すべてのETH転送がノードへのRPCコールや、ブロックルートにハッシュ化されるメルクルブランチの要求を通して簡単にアクセスできる何らかの記録に実装されることを保証する最も単純な実装です。ログの種類はERC-20トークン標準と互換性がありますが、過度に具体的なERC-20の機能(例えばABIエンコーディング)をこの仕様に導入していません。

### 未解決の問題

1. 引き出しもログをトリガーすべきですか? その場合、送信者アドレスはどのように指定されるべきですか?
2. 手数料の支払いもログをトリガーすべきですか? これにより"完全性"が確保され、ログを監視することで正確な現在の残高テーブルを計算できるようになりますが、ログの数が大幅に増加し、許容できない可能性があります。

## 下位互換性

下位互換性の問題はありません。

## テストケース

TODO

## セキュリティ上の考慮事項

ETH転送には最小で6700ガスがかかりますが、LOG3オペコードは1500ガスしかかかりません。したがって、このEIPはブロックに入れることができるログの最悪の場合の数を増加させません。平均的なログの数は若干増加します。

## 著作権

[CC0](../LICENSE.md)によりすべての著作権およびそれに関連する権利が放棄されています。