---
original: 3c208813585d8fca67a92d908ece47402f87a18a14f1b20ee5ebcb3e702dcc9c
---

---
eip: 155
title: シンプルなリプレイ攻撃保護
author: Vitalik Buterin (@vbuterin)
type: Standards Track
category: Core
status: Final
created: 2016-10-14
---

### ハードフォーク
[Spurious Dragon](./eip-607.md)

### パラメータ
- `FORK_BLKNUM`: 2,675,000
- `CHAIN_ID`: 1 (メインネット)

### 仕様

`block.number >= FORK_BLKNUM`かつ`CHAIN_ID`が利用可能な場合、トランザクションのハッシュ計算時に、6つのrlpエンコーディング要素`(nonce, gasprice, startgas, to, value, data)`のみをハッシュするのではなく、9つのrlpエンコーディング要素`(nonce, gasprice, startgas, to, value, data, chainid, 0, 0)`をハッシュする**SHOULD**です。そうする場合、署名の`v`は`{0,1} + CHAIN_ID * 2 + 35`に設定する**MUST**です。ここで`{0,1}`はsecp256k1署名プロセスにおいて`r`がx値である曲線点の`y`値の偶奇性を表します。6つの値のみをハッシュする場合、`v`は従来通り`{0,1} + 27`に設定されます。

`block.number >= FORK_BLKNUM`かつ`v = CHAIN_ID * 2 + 35`または`v = CHAIN_ID * 2 + 36`の場合、トランザクションのハッシュ計算時に、6つのrlpエンコーディング要素`(nonce, gasprice, startgas, to, value, data)`のみをハッシュするのではなく、9つのrlpエンコーディング要素`(nonce, gasprice, startgas, to, value, data, chainid, 0, 0)`をハッシュする必要があります。従来の`v = 27`および`v = 28`を使う署名スキームは引き続き有効で、以前と同じルールで動作し続けます。

### 例

`nonce = 9`, `gasprice = 20 * 10**9`, `startgas = 21000`, `to = 0x3535353535353535353535353535353535353535`, `value = 10**18`, `data=''` (空)のトランザクションを考えます。

"署名データ"は以下のようになります:

```
0xec098504a817c800825208943535353535353535353535353535353535353535880de0b6b3a764000080018080
```

"署名ハッシュ"は以下のようになります:

```
0xdaf5a779ae972f972197303d7b574746c7ef83eadac0f2791ad23db92e4c8e53
```

このトランザクションを秘密鍵`0x4646464646464646464646464646464646464646464646464646464646464646`で署名した場合、v,r,sの値は以下のようになります:

```
(37, 18515461264373351373200002665853028612451056578545711640558177340181847433846, 46948507304638947509940763649030358759909902576025900602547168820602576006531)
```

27ではなく37が使われていることに注意してください。署名済みのtxは以下のようになります:

```
0xf86c098504a817c800825208943535353535353535353535353535353535353535880de0b6b3a76400008025a028ef61340bd939bc2195fe537567866003e1a15d3c71ff63e1590620aa636276a067cbe9d8997f761aecb703304b3800ccf555c9f3dc64214b297fb1966a3b6d83
```

### 根拠

これにより、ETC(Ethereum Classic)やMorden testnetで動作するトランザクションをEthereumで送信できるようになります。ETCはこのEIPを採用することが推奨されますが、`CHAIN_ID`を異なる値に置き換えてください。また、すべての将来のテストネット、コンソーシアムチェーン、代替イーサリアムも、`CHAIN_ID`を一意の値に置き換えてこのEIPを採用することが推奨されます。

### Chain ID一覧:

| `CHAIN_ID`     | Chain(s)                                   |
| ---------------| -------------------------------------------|
| 1              | Ethereum メインネット                      |
| 2              | Morden (使用されていない), Expanse メインネット |
| 3              | Ropsten                                    |
| 4              | Rinkeby                                    |
| 5              | Goerli                                     |
| 42             | Kovan                                      |
| 1337           | Geth プライベートチェーン (デフォルト)        |

[chainid.network](https://chainid.network)でより多くのChain IDを確認し、[ethereum-lists/chains](https://github.com/ethereum-lists/chains)に貢献してください。