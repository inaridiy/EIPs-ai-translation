---
original: fe84e799fb90dbb9e308106547314fd8c9aa1e6fc1630b03f37a5750286eda16
---

---
eip: 1470
title: スマートコントラクトの脆弱性分類 (SWC)
author: Gerhard Wagner (@thec00n)
discussions-to: https://github.com/ethereum/EIPs/issues/1469
status: 停滞
type: 情報提供
created: 2018-09-18
---

## 簡単な要約

このEIPは、Ethereumスマートコントラクトのセキュリティ上の弱点を分類するスキームを提案しています。

## 概要

SWC (Smart Contract Weakness Classification)は、開発者、ツールベンダー、セキュリティ実践者向けのスマートコントラクト固有のソフトウェアの弱点分類スキームです。SWCは、[Common Weakness Enumeration - CWE](https://cwe.mitre.org)スキームで使用される用語と構造に緩く合わせつつ、スマートコントラクトに特有の多様な弱点バリアントを重ね合わせています。

SWCスキームの目的は以下の通りです:

- スマートコントラクトシステムの弱点を分類する明確な方法を提供する。
- スマートコントラクトシステムの脆弱性につながる弱点を特定する明確な方法を提供する。
- スマートコントラクトシステムのアーキテクチャ、設計、コードにおける弱点を記述するための共通言語を定義する。
- スマートコントラクトのセキュリティ分析ツールの訓練と性能向上を行う。

## 動機

ソフトウェアセキュリティ業界では、共通の用語を使用し、標準化されたスキームでセキュリティ関連のバグやエラーを分類することが広く受け入れられている慣行です。これは、ソフトウェアの脆弱性の発生を完全に防ぐことはできませんが、Webアプリケーション、ネットワークプロトコル、IoTデバイスなどさまざまな分野のコミュニティが、ソフトウェアのセキュリティ関連の問題の性質を理解し、ユーザーや開発者を教育するのに役立ってきました。また、セキュリティコミュニティが、さまざまなセキュリティ分析ソースから得られる脆弱性を迅速に理解し、根本原因分析やトリアージを行うことができるようになりました。近年、さまざまな組織や企業も脆弱性データを公開し、収集された脆弱性データに基づいて最も広範囲に存在するセキュリティ問題を特定するようになりました。広く使用され参照されている2つの例が、[SANS TOP 25 Most Dangerous Software Errors](https://www.sans.org/top25-software-errors)と[OWASP TOP 10](https://www.owasp.org/index.php/Top_10-2017_Top_10)です。これらの発表は、共通の分類スキームがなければ実現できませんでした。

現時点では、Ethereumスマートコントラクトに特有の弱点分類スキームは存在していません。セキュリティ上の弱点に関する共通言語と認識は、主に学術論文、ベストプラクティスガイド、公開記事から得られています。監査レポートやセキュリティツール分析からの所見は、発見された弱点を記述するために使用される用語の幅を広げています。セキュリティ専門家でも、さまざまなソースからの所見の技術的な根本原因とリスクを理解するのに時間がかかることが多いです。

## 根拠

現在のギャップを認識しつつ、SWCは、セキュリティ上の弱点の分類に関して既に成功している他のソフトウェアセキュリティコミュニティの取り組みを再発明することを目的としていません。むしろ、Common Weakness Enumeration (CWE)に着目しています。CWEは、採用と網羅性の点で際立っている、ソフトウェアの脆弱性の種類のリストです。CWEはスマートコントラクトに特有の弱点を記述していませんが、より抽象的なレベルの関連する弱点は記述しています。このEIPは、CWEの広範な範囲のソフトウェアエラーや間違いとリンクしながら、スマートコントラクト固有のバリアントを作成することを提案しています。

## 仕様

SWC仕様について説明する前に、使用される用語を説明することが重要です:

- 弱点 (Weakness): 適切な条件下で単独で、または他の弱点と組み合わせて、脆弱性につながる可能性のあるソフトウェアのエラーや間違い。
- 脆弱性 (Vulnerability): 直接的または間接的に、スマートコントラクトシステムの望ましくない状態につながる弱点または複数の弱点。
- バリアント (Variant): Ethereumスマートコントラクトに特化した非常に詳細な特定の弱点。各バリアントには固有のSWC IDが割り当てられます。
- 関係性 (Relationships): CWEには、弱点をより抽象的なレベルでグループ化する幅広い_Base_および_Class_タイプがあります。CWEは、_Relationships_を使用して、SWCスマートコントラクトの弱点バリアントを既存の_Base_または_Class_CWEタイプにリンクしています。_Relationships_は、SWCがソフトウェアセキュリティの弱点全般とどのように関連しているかを示すために使用され、問題データセットから有用な視覚化とインサイトを生成するのに役立ちます。現時点の改訂では、SWCをCWEの最も近い親にリンクすることが提案されています。
- SWC ID: バリアントに関連付けられた数値識別子 (例: SWC-101)。
- テストケース: テストケースは、1つ以上のSWCバリアントの具体的なインスタンスを示すマイクロサンプルまたは実世界のスマートコントラクトで構成されます。テストケースは、意味のある弱点分類の基礎となり、セキュリティ分析ツール開発者にとって有用です。

SWCの最も基本的な形式は、数値識別子をバリアントに関連付けることです。例えば、識別子_SWC-101_は_整数オーバーフローとアンダーフロー_バリアントにリンクされています。弱点のタイトルと一意のIDのリストだけでも有用ですが、さらに詳細が必要です。そのため、SWCはバリアントに定義とテストケースを追加することを推奨しています。

**SWC定義**

SWC定義はMarkdownフォーマットで記述され、可読性が高く、ツールで簡単に処理できるようになっています。以下の属性で構成されています。

- タイトル: 技術的な根本原因を示す弱点の名称。
- 関係性: CWE_Base_または_Class_タイプを、その CWE バリアントにリンクします。例えば、_整数オーバーフローとアンダーフロー_バリアントは、[CWE-682 - 不正な計算](https://cwe.mitre.org/data/definitions/682.html)にリンクされています。
- 説明: 弱点の性質と、コントラクトシステムに対する潜在的な影響を説明します。
- 修正方法: 弱点を修正する方法を説明します。
- 参考文献: 弱点に関する関連情報を含む外部参照へのリンクを提供します。

**テストケース**

テストケースには、脆弱なスマートコントラクトの作成サンプルと実際のサンプルが含まれています。単一のテストケースは3つのコンポーネントで構成されます:

1. スマートコントラクトサンプルのソースコード; 例: Solidity、Vyper など。
2. EVMコンパイラから生成されたマシン可読フォーマットのコンパイル資産; 例: JSON または ethPM。
3. 弱点バリアントのインスタンスの数と場所を記述するテスト結果の設定。提案されているテストケース設定のYAMLスキーマは以下の通りです。

```YAML
title: SWC config
type: object
required:
- description
- issues
properties:
  description:
    type: string
  issues:
    title: Issues
    type: array
    items:
      title: Issue
      type: object
      required:
      - id
      - count
      properties:
        id:
          type: string
        count:
          type: number
        locations:
          items:
            bytecode_offsets:
              type: object
            line_numbers:
              type: object
```

## 実装

このEIPで提案されたSWCスキームは、[GitHub リポジトリ](https://github.com/SmartContractSecurity/SWC-registry)にある「スマートコントラクトの弱点分類レジストリ」で使用されています。GitHub Pagesでレンダリングされたバージョンは[こちら](https://smartcontractsecurity.github.io/SWC-registry/)でも確認できます。

## 著作権
著作権およびその関連権利は[CC0](../LICENSE.md)で放棄されています。