---
original: 9e4d1027348064aee6c23aabe2f65b92ac26212e7c99daf37e65544edfd9da68
---

---
eip: 7044
title: 永続的に有効な署名された自発的退出
description: キャペラ上の自発的退出署名ドメインをロックして永続的な有効性を確保する
author: Lion (@dapplion)
discussions-to: https://ethereum-magicians.org/t/eip-7044-perpetually-valid-signed-voluntary-exits/14348
status: 最終
type: 標準トラック
category: コア
created: 2023-05-18
---

## 概要

キャペラ上の検証者の自発的退出署名ドメインをロックして永続的な有効性を確保する。現在、署名された自発的退出は2つのアップグレードまでしか有効ではありません。

## 動機

現在、署名された自発的退出は、ビーコンチェーンの状態が現在のフォークバージョンと前のフォークバージョンしか考慮しないため、ブロックに含まれるのは2つのアップグレードまでしか有効ではありません。この制限は、ステーキング事業者(アクティブキーの保有者)と資金の所有者(引き出し資格情報の保有者)が別々の場合など、一部のステーキング操作の複雑性を高めています。自発的退出は、アクティブキーによってのみ署名できるため、このような関係では、無制限の数のフォークに対して事前に署名された退出を交換する必要があります。

自発的退出の有効期間の制限は、ハードフォークの結果として2つのメンテナンスされるチェーンが存在する場合に、それらを分離するために当初動機付けられていました。フォークAとBが存在し、バリデーターがそれらの両方で動作している場合、退出を送信すると、両方で再生可能になります。しかし、この可能性は資金が危険にさらされず、ステーカーが一方または両方のチェーンで再ステークできるため、上述のUXの劣化を正当化するには十分ではありません。

## 仕様

### コンセンサスレイヤー

仕様の変更はコンセンサス仕様デネブアップグレードに組み込まれています。

具体的には、状態遷移関数に1つの変更を加えます:

- [`process_voluntary_exit`](https://github.com/ethereum/consensus-specs/blob/75971a8c218b1d76d605dd8b88a08d39c42de221/specs/deneb/beacon-chain.md#modified-process_voluntary_exit)を変更して、署名ドメインとルートを`CAPELLA_FORK_VERSION`で固定する。

さらに、`voluntary_exit`ゴシップ条件は、この変更をサポートするように暗黙的に変更されます。

下位互換性を確保するため、署名ドメインはキャペラフォークでロックされます。

### 実行レイヤー

この仕様には、実行レイヤーへの変更は必要ありません。

## 根拠

永続的に有効な署名された自発的退出により、ステーキング操作の設計がより単純になります。また、`BLSToExecutionChanges`や預金などのオブジェクトのUXにも合わせられるため、下流のツールはフォークバージョン情報を更新する必要がなくなります。

## 下位互換性

この変更は、Ethereumのブロック処理ロジックのコンセンサスレイヤーと下位互換性があります。

退出の将来的な有効性の期待は、前方互換性がありません。具体的には、デネブフォークドメインを使用して事前に署名された退出の有効性を期待していたユーザーは、これらの事前署名された退出が有効と認識されなくなることを認識する必要があります。したがって、ユーザーは今後のアプローチを調整する必要があります。デネブおよび後続のフォークにわたる継続的な有効性を確保するには、ユーザーはキャペラフォークドメインを使用して退出に署名する必要があります。

実行レイヤーとの前方/下位互換性の問題はありません。

## テストケース

このEIPのテストケースは、`consensus-specs`リポジトリの[`deneb`](https://github.com/ethereum/consensus-specs/tree/2297c09b7e457a13f7b2261a28cb45777be82f83/tests/core/pyspec/eth2spec/test/deneb)テストスイートにあります。

## セキュリティ上の考慮事項

フォークされたネットワーク間の異なる署名ドメインにより、以前は2つのハードフォーク後にVoluntaryExitsの再生が防がれていました。この仕様の変更により、この再生保護が存在しなくなります。これらの潜在的な再生は、フォークの両側の個々のステーカーに影響を与える可能性がありますが、資金は危険にさらされず、チェーンのセキュリティにも影響しません。

## 著作権

著作権およびそれに関連する権利は[CC0](../LICENSE.md)で放棄されています。