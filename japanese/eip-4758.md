---
original: 8e4973a1ea21de41953a6ff56ba17f2e45067559963e8f9ab5aeb3b624ea5def
---

---
eip: 4758
title: SELFDESTRUCT の無効化
description: SELFDESTRUCT を SENDALL に変更し、すべての資金をコールする側に回収するが、コードやストレージは削除しないようにする。
author: Guillaume Ballet (@gballet), Vitalik Buterin (@vbuterin), Dankrad Feist (@dankrad)
discussions-to: https://ethereum-magicians.org/t/eip-4758-deactivate-selfdestruct/8710
status: 停滞
type: Standards Track
category: Core
created: 2022-02-03
---

## 概要

この EIP は、`SELFDESTRUCT` オペコードを `SENDALL` に名称変更し、その機能を変更します。新しい機能は、アカウントにある全ての Ether を呼び出し側に送金することのみとなります。

## 動機

`SELFDESTRUCT` オペコードは、アカウントの状態に大きな変更を加えます。特に、すべてのコードとストレージを削除します。これは、Verkle ツリーの将来的な実装では不可能になります。各アカウントは、ルートアカウントに明確に関連付けられない多数のアカウントキーに格納されるためです。

この EIP はこの変更を実装します。`SELFDESTRUCT` を使用してのみ資金を回収するアプリケーションは引き続き機能します。

## 仕様

* `SELFDESTRUCT` オペコードは `SENDALL` に名称変更され、今後は即座にアカウントの全ての ETH を対象に送金するだけになります。コードやストレージの破壊、ノンスの変更は行いません。
* `SELFDESTRUCT` に関連するすべての払い戻しは削除されます。

## 根拠

`SELFDESTRUCT` オペコードの廃止は以前から検討されており、現在強い理由はありません。これを無効化することは、ステートレス性の要件となります。

## 下位互換性

この EIP はコンセンサスルールを変更するため、ハードフォークが必要です。

この変更の影響を受けるアプリケーションは少ないです。唯一の影響は、`CREATE2` を使用して同じアドレスに再作成されるコントラクトです(`SELFDESTRUCT` の後)。

## セキュリティ上の考慮事項

以下のような `SELFDESTRUCT` の用途は壊れ、これらを使用するアプリケーションは安全ではなくなります:

1. `SELFDESTRUCT` を使用してコントラクト内の非 ETH トークンバランス(例: [EIP-20](./eip-20.md))を焼却する用途。このような用途は知られていません(バーンアドレスに送金すれば簡単にできるため)。
2. `CREATE2` を使用してコントラクトを同じ場所に再デプロイする用途。これには2つの失敗パターンがあります:
    * 破壊によって、特定のコンテキスト外でコントラクトを使用できなくなる。例えば、誰でも資金を引き出せるコントラクトで、最後に `SELFDESTRUCT` を使用してこれを防ぐ。このような操作は `SELFDESTRUCT` に依存せずに変更できます。
    * `SELFDESTRUCT` を使用してコントラクトをアップグレード可能にする。これはサポートされなくなり、代わりにデリゲートを使用する必要があります。

## 著作権

[CC0](../LICENSE.md)によりすべての著作権およびそれに関連する権利が放棄されています。