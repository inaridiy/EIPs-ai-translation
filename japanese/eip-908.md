---
original: 6e552efe793e5e4b327b3435d60dee49cfeba8e9978473291ecc59e7b3830e8c
---

---
eip: 908
title: 持続可能なネットワークのためのクライアントへの報酬
author: James Ray (@jamesray1), Micah Zoltu (@MicahZoltu)
discussions-to: https://ethereum-magicians.org/t/eip-908-reward-full-nodes-and-clients/241
status: 取り下げられた
type: Standards Track
category: Core
created: 2018-03-01
---

## フルノードへの報酬は廃止されたが、クライアントへの報酬提案は残っている

Casperバリデーターはトランザクションの検証に対するインセンティブがあるが、ブロックの中継や状態データの保存(状態を含む)に対するインセンティブはまだない。このペーパーはより具体的な解決策を提案するよりも、高レベルの分析と議論を行うものである。[Pocket Network](https://www.pokt.network/)は2018年9月時点で開発中の別のブロックチェーンで、トランザクションの中継に対するインセンティブを提供することを目的としている。また、[Rocket Pool](https://github.com/rocket-pool/rocketpool)の開発も進行中で、Casperのためのプールとなる予定である。これにより、フルノードの運用がインセンティブ付けられる。別の選択肢として、[VIPnode](https://github.com/vipnode/vipnode.org)がある。これはライトクライアントがフルノードに手数料を支払うというものである。これらの解決策が開発されていることを考えると、クライアントへの一般的な報酬アプローチとしては、帯域(中継とダウンロード)、ストレージ、I/Oをインセンティブ付けることが適切かもしれない(計算はすでにマイナーのガスで、シャーディングとCasperの下でプロポーザーにもインセンティブが付与される)。また、シャーディングの下では、ノータリーがコレクションをダウンロードするインセンティブがある。(Casper FFGはイーサリアム2.0のシャーディングと共に実装される予定: [shasper](https://notes.ethereum.org/SCIg8AH5SA-O4C1G1LYZHQ#))。Casper FFGの実装が近いことを考えると、プロトコルの複雑性を最小限に抑えるため、当面の間バリデーションをインセンティブ付けることは価値がないかもしれない。以前のバージョンの提案には、フルノードへの報酬に関する提案が含まれていた。詳細は[こちら](https://github.com/ethereum/EIPs/commit/97e235d0ba4a88b4ce29834aa2b94107b8d91e12#diff-9a43a8739b5a9e1dec427324cb264921)を参照。

## 簡単な要約
各トランザクションの検証時に、クライアントの開発に対する報酬を与える。

## 概要
共有資源の過剰利用による「悲劇の共有地」は、持続可能性の面で多くの分野で知られている現象である。これは、関係者全員(場合によっては将来世代も含む)に悪影響を及ぼす。公共資源の適切な管理がなされない場合、「悲劇の共有地」が発生する可能性がある。外部性の内部化(財やサービス、資源の本来の価格に反映されていない影響を外部性と定義する)は、資源の適切な管理を促すひとつの方法であるが、実際に適切に管理するためには他の方法も必要である。このEIPは、イーサリアムの機能を可能にするソフトウェアを提供するクライアントに報酬を与えるためのプロトコルの変更を提案する。報酬には、現在マイナーが受け取る手数料の一部と、新規に発行されるETHの一部が含まれる。これにより、クライアントはイーサリアムプロトコルとエコシステムのセキュリティと健全性を維持・向上させるインセンティブが与えられる。提案のメカニズムを要約すると、トランザクションにはユーザーエージェントが添付され、このユーザーエージェントにはアクセスリストのインデックスを示すベクトルが含まれる。クライアントのストレージ内の読み取り専用の定数と同じアドレスが挿入される。

プロトコルに組み込まれていない報酬メカニズムは、このEIPの範囲外である。そのような外部プロトコルの報酬方法には、レシートなどの高速情報を提供するライトクライアントサーバーへの状態チャネル支払い、フルノードから状態読み取りを購入するための状態チャネル支払い、アーカイブサービス(将来提案されるイーサリアムのステートレスクライアントに適用される)、クライアントとフルノードの運用に対するトークンなどがある。

## 動機
現在、フルノードを運用するインセンティブがない一方で、マイニングプールに参加するのは、Ethereum がCasper FFGを経てPoSに移行するまでに投資回収できない可能性が高いため、経済的ではない。

さらに、クライアントへの報酬は、状態チャネルやその他のレイヤー2メカニズムから独立した収益源を提供する。これらのメカニズムはセキュリティが低いが、保険、ボンド支払い、タイムロックなどのメカニズムで補うことができる。クライアントがイーサリアムエコシステムを支える存在であるため投資家が投資するという論理付けは、うまくスケールしない可能性があり、クライアントが提供するサービスの一部として収益化することがより持続可能だと考えられる。

イーサリアムのプレマイニング(プレICOおよびICO)で得られた資金を使ってクライアント開発を資金提供できるという議論もあるが、ParityがVCファンディングを受けていること、Prysmatic Labs[1](https://medium.com/@XYOracleNetwork?source=search_post)、[2](https://twitter.com/prylabs/status/996391036753666050)、[3](https://medium.com/prysmatic-labs/biweekly-development-update-2-d29d0c91e7d0)、[exthereum](https://medium.com/compound-finance/introducing-exthereum-the-newest-ethereum-client-7a5e30d4d6aa)などの他のクライアントも別の資金源から資金を得ていることから、その議論は疑問が残る。[Drops of Diamond](https://github.com/Drops-of-Diamond/diamond_drops)はまだ資金を得ていない。

クライアント開発へのインセンティブ付けは、プロトコルに必要な資源の供給をより直接的に促進し、「悲劇の共有地」の発生を防ぐことができる。プロトコルが使用不能になるような供給不足と需要過剰の状況を避けられるためである。

[ここ](https://eprint.iacr.org/2014/452.pdf#subsection.2.1)のBitcoin、PoW、PoS/PoWハイブリッドプロトコルの文脈での分析を参照。イーサリアムにはガス制限があるが、市場規模が大きくなり、ネットワークへの攻撃のインセンティブが高まる一方で、セキュリティコストとトランザクション手数料の比率が上がらないことが指摘されている。PoSはこの問題を軽減するが、トランザクションの伝播、検証、保存のコストがインセンティブ付けられていないことが指摘されている。「Proof of Activity: Extending Bitcoin's Proof of Work via Proof of Stake」論文にも、目標参加率をインセンティブ付ける方式が含まれている。

> 「Proof of Activity」の「activity」という言葉は、オンラインのフルノードを維持する活発なステークホルダーにのみ報酬が与えられることを強調している。これは、オフラインのステークが時間とともに重みを増し、最終的には二重支払い攻撃に利用される可能性のある従来のPoSとは対照的である。

トランザクションの中継とデータ(状態を含む)の保存にもインセンティブを与えることができる。これらは本EIPの範囲外だが、[ここ](https://ethresear.ch/t/incentivizing-a-robust-p2p-network-relay-layer/1438)と[ここ](https://ethresear.ch/t/incentivizing-full-state-nodes/1640)に提案がある。

レイヤー2ソリューションとして実装すると、プロトコルの持続可能性を確保できない可能性がある。プロトコルにフルノードがトランザクションを検証するためのコストがない場合、人々はそれを利用し続けるだろう。少なくともプロトコル内で報酬を提供する部分は必要だが、ユーザーエージェントの署名以外には特に付け加えるものはない。そのため、一部をプロトコル内で、一部を例えば検証やゲームオフプロトコルで行うことができるが、すでにプロトコル内で行われている。また、計算量の多い作業はガス制限に収まらないため、Truebitのように検証者にインセンティブがある外部で行うことも可能である。

クライアントへのインセンティブを提供しないことは、ユーザーのニーズに合ったクライアントを構築するインセンティブが低下し、クライアント開発資金をプロトコル外から調達する必要があるため、分散化が低下する可能性がある問題である。クライアント開発資金を調達できるのがVCや個人投資家、機関投資家などの一部に限定されると、現在および潜在的なすべてのイーサリアムステークホルダー(将来のステークホルダーを含む)の利益に必ずしも合致しない可能性がある。イーサリアムの目標の1つは、富の分散化、つまり富の平等の向上である。トランザクションを検証するフルノードにインセンティブを与えないことは現時点では大きな問題とは見なされていないが、プロトコルの成長を阻害する可能性がある。もちろん、インセンティブだけでは不十分で、低スペックのメインストリームPCや、場合によってはモバイルやIoTデバイスでも検証フルノードになれるか、少なくともネットワークのセキュリティに貢献できるよう、技術的な分散化も必要である。

供給上限(EIP-960のように)を設けることで、発行量の無制限の増加を防ぐことができる。あるいは、スラッシング参加者(Casper PoSのバリデーターやシャーディングのノータリーなど)に応じてイーサが焼却される速度と同じ速度で、少なくとも0にはならない(あるいは0になる可能性もある)ように、発行量を削減することもできる。例えば、ハードフォークによる、あるいはEIP-1015のように、ステークホルダーを表すいくつかのコントラクトからのシグナルに基づいて意思決定アセンブリによって管理されるオンチェーンコントラクトによって行うことができる。

## 仕様
ブロックに新しいフィールド `PrevBlockVerifications` を追加する。これは任意の長さのバイト配列である。クライアントが以前のブロックが[有効](https://ethereum.github.io/yellowpaper/paper.pdf#subsubsection.4.3.2)であることを検証すると、PREV_BLOCK_VERIFオペコードを使ってトランザクションにユーザーエージェントを追加する。ユーザーエージェントは、検証したブロックのブロックハッシュと、アクセスリストのインデックスを示すベクトルで構成される。ミナーはトランザクションを含める前に検証するが、これらのベクトルのフィールドを変更することはできない(不変のため)。

ブロック処理時に、クライアントに0.15 ETHを送金する(下記の根拠参照)。この金額には、トランザクション手数料の一部(その分マイナーの受け取り額が減る)と、新規発行ETHの一部が含まれる。これらの金額は、ブロックの新しい `ClientReward` フィールドで指定される。

最近のブロックのみを検証するよう奨励するため、ブロックナンバーがさかのぼって400ブロック以内であることを確認する。

### 攻撃と防止策

ミナーがクライアントを作成し、PREV_BLOCK_VERIFオペコードのみ(あるいは複雑なトランザクションでも同様)を含むトランザクションを自身のブロックに大量に入れ、検証したブロックハッシュとクライアントのアドレスを含めることが考えられる。これを防ぐには、ミナー(またはCasper CBCの下でのプロポーザー)がデポジットを預け、そのようなトランザクション(以前に提案したブロックハッシュを含むト
ランザクション)を含めた場合にスラッシングされるようにする必要がある。400ブロック以上前のブロックハッシュを削除するのは追加のオーバーヘッドがかかるが、さらに過去の120,000ブロック(約3週間)分のウィンドウを設け、400ブロック以上前のものは無視し、120,000ブロックごとにこれらの古いブロックを削除するといった対応も考えられる。攻撃者がミナー/プロポーザーに働きかけて、アクセスリストにある自身のクライアントアドレスを含むような上記のようなトランザクションを含めさせる可能性もある。しかし、上記のスラッシング条件によりこのような行為を抑止できるはずである。

### アクセスリストの詳細

アクセスリストは、誰でもベクトルの最初の要素にアドレスを挿入できないようにする。アドレスの登録を管理する権限の集中と検閲を防ぐ方法として、例えば[EIP-1015](./eip-1015.md)のようなオンチェーンガバナンスでのシグナリング、あるいはスマートコントラクトを通じて新しいアドレスを追加できるようなレイヤー2のプルーフ・オブ・オーソリティネットワークなどが考えられる。ただし、これらの例には深刻な欠点もある。[オンチェーンガバナンス](https://medium.com/@Vlad_Zamfir/against-on-chain-governance-a4ceacd040ca)や[plutocracy](https://vitalik.ca/general/2018/03/28/plutocracy.html)に対する反論がある。[プルーフ・オブ・オーソリティ](https://en.wikipedia.org/wiki/Proof-of-authority)は、信頼の分散が良くないため、パブリックネットワークには適していない。しかし、レイヤー2のコントラクトでシグナリングを使うのは受け入れられる。ただし、Vlad Zamfirは、それをプロトコルのガバナンスプロセスに影響させることは、マイナーの必要不可欠な参加者としての地位を奪うと主張している。したがって、これらの反論を踏まえると、アクセスリストを管理する分散化された信頼できない方法が実装・受け入れられるまでは適切ではないかもしれない。

別の選択肢としては、アクセスリストのインデックスから取得したアドレスが「正当な」クライアントのものであることを分散的に検証する方法がある。この検証の一部として、そのアドレスを所有するクライアントが自らを主張し、この方法での資金受け取りに同意していること、そしてイーサリアムのテストスイートですべてのテストに合格していることを確認する。ただし、後者の条件では、開発初期の新規クライアントの資金調達が阻害される可能性がある(ただし、クライアントが実装されるまでは、この方法での資金受け取りはできない)。これらはすべてオフチェーンで行うことができ、誰かがアクセスリストの何らかのアドレスが正当ではないと判断した場合は、不正性の証明を提出してそのアドレスを削除できるようにし、そのアドレスをリストに登録した参加者をスラッシングする(登録時にデポジットを預けている必要がある)。

さらに、クライアントからのみアドレスを読み取れるようにし、アドレスがアクセスリストにない場合はトランザクション全体を巻き戻すようにするのも良いだろう。アクセスリストのインデックスを提供し、そのインデックスの位置にあるアドレスがクライアントが読み取れるアドレスと一致することを `assert` するといった具合である。

## 根拠

### 手数料の定性的な分析

2018年5月4日時点で、[16,428ノード](https://web.archive.org/web/20180504051128/https://ethernodes.org/network/1)がある。平均的なクライアント開発組織の年間コストを100万ドルと仮定する。5年後には30,000ノードに倍増すると予想(保守的な仮定)し、クライアントが10社あると仮定する。この場合の1クライアントあたりのコストは以下のようになる。

1クライアントあたりの平均コスト = ノード数 * 1クライアントあたりのブロック報酬 / クライアント数

1クライアントあたりのブロック報酬(ETH価格が低い場合) = 1クライアントあたりの平均収入 * クライアント数 / (ETH為替レート * ノード数)
= 200万ドル * 10 / (500 * 30,000)
= 1.333333333 ETH

1クライアントあたりのブロック報酬(ETH価格が高い場合) = 100万ドル * 10 / (2000 * 30,000) = 0.166666667 ETH

クライアントへの報酬を0.15 ETHとする。

<!--5,552,465ブロック以上あり、それぞれ0.001 ETHの報酬があれば、すべてのブロックを検証したフルステートノードは5,552.465 ETHを受け取れる。しかし、ブロックの検証の難易度は時間とともに上がるため、-->

### その他の根拠(上記の分析により古くなっている)

トランザクションの検証に必要な計算量はマイナーと同じであり、トランザクションを実行する必要があるため、フルノードとクライアントにトランザクション手数料を支払うのであれば、マイナーと同じ方法で計算するのが適切である。ただし、これは手数料が大幅に増加することを意味し、議論の的となる。つまり、フルノードバリデーターにマイナーと同額のトランザクション手数料を支払うべきか(検証に同じ計算量を要するため公平だが)、それとも手数料の上昇を抑えるため、マイナーの手数料をバリデーターの平均数で割った額にするべきか、という議論がある。後者のオプションはさらに議論の的となるが(現状よりはましだが)、フルノード運用へのインセンティブはあるものの、同じ計算量を行うにもかかわらず報酬が少ないためである。

具体的な金額については、データ分析が必要だが、フルノードがブロック内のトランザクションを処理する際の報酬は、ブロックの多数の確認があるため、マイナーよりも大幅に少なくすべきである。データ分析には、ブロック内で平均的にどのくらいのフルノードがトランザクションを検証しているかを計算するなどが含まれる。また、マクロ経済的な分析として、フルノードがネットワークのセキュリティに与える経済的な恩恵を検討することも必要だろう。

クライアントとフルノードの報酬の比率については、初期的な推測として99:1程度がよいと考える。なぜそこまで大きな差なのか。クライアントの開発・メンテナンスにかかる時間がフルノードの運用・メンテナンスの99倍ほどかかると推測されるためである。1週間の間、フルノードの運用には半時間(それ以下)しかかからないが、クライアントには複数の常勤スタッフが数週間取り組む。フルノード運用者はコンピューターをアップグレードする必要もなく(マイニングリグを購入する価値もない)、Casper PoSの実装が近いため。

しかし、さらに分析を進めると、クライアントはフルノードの報酬の恩恵も受けられるため、フルノード運用のインセンティブをさらに高めるため、比率を4:1や1:1に変更することも検討できる。もちろん、実際のデータ分析に基づいて調整することが望ましい。

フルノードバリデーターとクライアントへの報酬を提供すると、発行量が増加する。現在の発行量を維持するため、このEIPではマイニング報酬を減らすこともできる(2017年10月のByzantiumリリースで5 ETHから3 ETHに減少したが、さらなる減少は議論を呼ぶ可能性がある)。

クライアントとフルノードへの報酬に関する別の論点として、これまでその作業に対する報酬がなかった(イーサリアム財団やParityのVCによる資金提供を除く)ため、既存クライアントが新規参入者に有利になるという指摘がある。しかし、既存クライアントには先行者利益があり、多くの開発を行って有用で広く使われるプロダクトを作り上げてきたため、この指摘は説得力に欠ける。

トレードオフがある。手数料が高いと、貧困層や手数料を支払いたくない人が排除される可能性がある。しかし、ラップトップでフルノードを運用し報酬を得られれば、手数料の支払いを相殺できる。フルノードはセキュリティ面での恩恵があるため、少なくともその一部を手数料に充てるべきだろう。クライアント開発を奨励する手数料は、より高品質なクライアントの開発につながる。できるだけコストを内部化することが重要だと考える:計算、ストレージ、帯域、I/O、クライアント開発、フルノード運用、マイニング/検証など。外部化すると「悲劇の共有地」が発生するが、内部化すれば持続可能性が高まり、富裕層の寛容さに頼る必要がなくなる(哲学的には、結局富裕層の寛容さは強制できない、彼らの善意に頼らざるを得ない)。

フルノードに関する報酬については、[シャーディングのフェーズ1仕様案](https://ethresear.ch/t/sharding-phase-1-spec/1407)では、プロポーザーとしてのフルノードにはブロブ(実行なし)やフェーズ3のトランザクション(実行あり)の提案に対する報酬がある。しかし、プロポーザーではなく単にトランザクションを検証するフルノード、あるいは[フルステートノード](https://ethresear.ch/t/incentivizing-full-state-nodes/1640)にはインセンティブがない。

さらなる定量的な分析を行い手数料を具体化すべきだが、オンチェーンで実装した後も一定の実験が必要かもしれない。

### セキュリティ
以下の取り消し線部分は、アクセスリストの使用と、クライアントが提供する読み取り専用アドレスがアクセスリストのアドレスと一致することの検証、およびアクセスリストの検閲耐性と集中化の最小化のためのレイヤー2ソリューション(PoAネットワークなど)によって防ぐ必要がある。

詳細な議論は[こちら](https://ethresear.ch/t/incentives-for-running-full-ethereum-nodes/1239)。

## 下位互換性

プロトコル内の手数料の導入は下位互換性のない変更なので、ハードフォークで行う必要がある。

## テストケース
TODO

## 実装
TODO

## 著作権

著作権およびその関連権利は[CC0](../LICENSE.md)で放棄されています。