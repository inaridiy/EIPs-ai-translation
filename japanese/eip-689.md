---
original: eec70eb7ac9fcc48ba105d2f2eeafba3493ce9a4c56aeb635ea4acfe8e636a54
---

---
eip: 689
title: コントラクトアドレスの衝突によるプログラムの異常終了
author: Yoichi Hirai <i@yoichihirai.com>
type: Standards Track
category: Core
status: Stagnant
created: 2017-08-15
---

## 簡単な要約

このEIPは、コードが既に存在するアカウントでのコントラクト作成を失敗させることを提案します。

## 概要

コンセンサステストスイートの一部のテストケースでは、既にコードが存在するアドレスにコントラクトをデプロイしようとしています。このようなケースは、Constantinople フォーク前にはメインネットワークでは事実上起こり得ませんが、クライアントの動作の違いを検出しました。現在のYellow Paperでは、アドレスの衝突がある場合でも、コントラクト作成は空のコードと初期ノンスから始まると述べられています。セマンティクスを単純化するため、このEIPではアドレスの衝突によってコントラクト作成が失敗するよう提案します。

## 動機

このEIPはメインネットの歴史には実用的な関連性はありませんが、テストと推論を簡素化します。

このEIPはConstantinople フォーク後は影響がありません。なぜなら[EIP-86](./eip-86.md)にこのEIPで提案された変更が含まれているためです。Constantinople フォーク前でも、このEIPは実用的な関連性はありません。なぜなら、この変更はkeccak256のハッシュ衝突の場合にのみ表れるためです。

テストに関しては、このEIPによりクライアントがコードの上書きの巻き戻しをサポートする必要がなくなります。

推論に関しては、このEIPにより非空のコードが決して変更されないという不変条件が成り立ちます。

## 仕様

`block.number >= 0`の場合、ノンスが0以外または空でないコードを持つアカウントでコントラクト作成が行われると、初期化コードの実行が例外的に終了したかのようにコントラクト作成が失敗します。これはコントラクト作成トランザクションとCREATE命令によって引き起こされるコントラクト作成に適用されます。

## 根拠

テストに合格させるために使われない機能を実装するのは現実的ではありません。このEIPによりクライアントの実装が簡素化されます。

## 下位互換性

このEIPはメインネットワークでは下位互換性があります。

## テストケース

少なくとも`createJS_ExampleContract_d0g0v0_EIP158`というBlockchainTestでは、このEIPを実装しているクライアントと実装していないクライアントを区別できます。

## 実装

## 著作権
[CC0](../LICENSE.md)によりすべての著作権およびそれに関連する権利が放棄されています。