---
original: 43e009658d0158580ea1aafc9b336271449cd51a761dda1624017cbbfd43afac
---

---
eip: 3554
title: 2021年12月までの難易度爆弾の遅延
author: James Hancock (@madeoftin)
discussions-to: https://ethereum-magicians.org/t/eip-3554-ice-age-delay-targeting-december-2021/6188
status: 最終版
type: Standards Track
category: Core
created: 2021-05-06
---

## 簡単な要約
2021年12月の第1週にその効果が現れるように、難易度爆弾を遅延させます。

## 概要
`FORK_BLOCK_NUMBER`から始まり、クライアントは実際のブロック番号よりも9,700,000ブロック遅れた番号を使って難易度を計算します。

## 動機
上海アップグレードや/またはマージが2021年12月までに行われることを目標としています。その時点で爆弾を再調整するか、完全に取り除くことができます。

## 仕様
#### 偽のブロック番号を使って難易度を緩和する
`calc_difficulty`の目的で、指数関数的な氷河期コンポーネントで使用されている`block.number`を、次の式に置き換えます:
```py
    fake_block_number = max(0, block.number - 9_700_000) if block.number >= FORK_BLOCK_NUMBER else block.number
```

## 根拠

以下のスクリプトは、12月第1週にブロック時間が0.1秒遅れ、月末までに1秒遅れることを予測しています。これにより、必要に応じて対応する余地があるため、対処する必要性が生じます。

```python
def predict_diff_bomb_effect(current_blknum, current_difficulty, block_adjustment, months):
    '''
    指定した月数後の将来のブロック時間への影響(比率)を予測します。
    最後の予測で使用された変数:
    current_blknum = 12382958
    current_difficulty = 7393633000000000
    block adjustment = 9700000
    months = 6
    '''
    blocks_per_month = (86400 * 30) // 13.3
    future_blknum = current_blknum + blocks_per_month * months
    diff_adjustment = 2 ** ((future_blknum - block_adjustment) // 100000 - 2)
    diff_adjust_coeff = diff_adjustment / current_difficulty * 2048
    return diff_adjust_coeff 


diff_adjust_coeff = predict_diff_bomb_effect(12382958,7393633000000000,9700000,6)
```

## 下位互換性
既知の下位互換性の問題はありません。

## セキュリティ上の考慮事項
難易度の影響を誤って判断すると、ハードフォークがリリースされるまで、予想よりも長いブロック時間が発生する可能性があります。難易度の大幅な変動はこの数値に大きな影響を与える可能性があります。また、長期的な難易度の調整による段階的なブロック時間の変化は、難易度爆弾のエポックのタイミングに影響を与える可能性があります。これはネットワークの使いやすさに影響しますが、セキュリティ上の問題につながる可能性は低いと考えられます。

## 著作権
[CC0](../LICENSE.md)によりすべての著作権およびそれに関連する権利が放棄されています。